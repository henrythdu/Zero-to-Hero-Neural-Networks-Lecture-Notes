{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "aca2c20f",
   "metadata": {
    "papermill": {
     "duration": 0.024289,
     "end_time": "2024-07-02T17:11:38.634565",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.610276",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Introduction\n",
    "\n",
    "This notebook is my note for Zero to Hero series by Andrej Karparthy video series - [Micrograd](https://www.youtube.com/watch?v=VMj-3S1tku0&list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ). I'm making this note as detailed as possible so if you don't want to watch the video, this notebook should have enough information :).\n",
    "\n",
    "This notebook layout is as follow:\n",
    "- Understand the derivatives\n",
    "- Build a basic building block Value class to do gradient decent\n",
    "- Manually back propagate\n",
    "- Automatic back propagate\n",
    "- Some common bugs\n",
    "- Build a simple MLP and watch the loss go down :)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47c6e691",
   "metadata": {
    "papermill": {
     "duration": 0.024262,
     "end_time": "2024-07-02T17:11:38.683085",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.658823",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Derivatives\n",
    "- Neural Network is basically a mathematical expression backpropagation is the mathematical core of many deep neural network - tune the weight of the neural network and minimize the loss function. To understand backpropagation, we need to understand derivatives.\n",
    "- Derivative in a simple term is the slope of the function at a given x\n",
    "- Practically we can't derive the derivative of a function since we would have hundred to thousand of terms. We would use this definition of derivative to find the slope instead\n",
    "<p align=\"center\">\n",
    "  <img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/aae79a56cdcbc44af1612a50f06169b07f02cbf3\" />\n",
    "</p>\n",
    "\n",
    "\n",
    "\n",
    "- "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e25ca272",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:38.734308Z",
     "iopub.status.busy": "2024-07-02T17:11:38.733448Z",
     "iopub.status.idle": "2024-07-02T17:11:38.746856Z",
     "shell.execute_reply": "2024-07-02T17:11:38.745709Z"
    },
    "papermill": {
     "duration": 0.041557,
     "end_time": "2024-07-02T17:11:38.749485",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.707928",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import math\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a4b0887",
   "metadata": {
    "papermill": {
     "duration": 0.023788,
     "end_time": "2024-07-02T17:11:38.797528",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.773740",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Simple function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b471dec2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:38.847334Z",
     "iopub.status.busy": "2024-07-02T17:11:38.846922Z",
     "iopub.status.idle": "2024-07-02T17:11:38.852303Z",
     "shell.execute_reply": "2024-07-02T17:11:38.851109Z"
    },
    "papermill": {
     "duration": 0.033603,
     "end_time": "2024-07-02T17:11:38.855102",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.821499",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def f(x):\n",
    "    return 3*x**2 - 4*x + 5 # Parabola function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2c982204",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:38.904727Z",
     "iopub.status.busy": "2024-07-02T17:11:38.904315Z",
     "iopub.status.idle": "2024-07-02T17:11:39.191492Z",
     "shell.execute_reply": "2024-07-02T17:11:39.190416Z"
    },
    "papermill": {
     "duration": 0.315137,
     "end_time": "2024-07-02T17:11:39.194262",
     "exception": false,
     "start_time": "2024-07-02T17:11:38.879125",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fca7cf97430>]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "xs = np.arange(-5,5,0.25)\n",
    "ys = f(xs) #Applying the function to every element in \n",
    "plt.plot(xs,ys)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "49fe4548",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.244904Z",
     "iopub.status.busy": "2024-07-02T17:11:39.244478Z",
     "iopub.status.idle": "2024-07-02T17:11:39.251725Z",
     "shell.execute_reply": "2024-07-02T17:11:39.250524Z"
    },
    "papermill": {
     "duration": 0.035619,
     "end_time": "2024-07-02T17:11:39.254358",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.218739",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14.00300000000243\n",
      "0.0\n"
     ]
    }
   ],
   "source": [
    "a = 3\n",
    "h = 0.001 # Decreasing the h would help to converge toward the correct answer, \n",
    "          # however there's a limit of how small h can be before we run into an error \n",
    "print((f(a + h) - f(a))/h)\n",
    "\n",
    "h = 0.00000000000000000001\n",
    "print((f(a + h) - f(a))/h) #Notice the slope becomes 0"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3110577d",
   "metadata": {
    "papermill": {
     "duration": 0.024426,
     "end_time": "2024-07-02T17:11:39.303783",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.279357",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Increase function complexity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "dc77cb9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.354780Z",
     "iopub.status.busy": "2024-07-02T17:11:39.354349Z",
     "iopub.status.idle": "2024-07-02T17:11:39.359303Z",
     "shell.execute_reply": "2024-07-02T17:11:39.358229Z"
    },
    "papermill": {
     "duration": 0.033699,
     "end_time": "2024-07-02T17:11:39.361974",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.328275",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def f2(a,b,c):\n",
    "    return a*b + c"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e200dd7a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.414584Z",
     "iopub.status.busy": "2024-07-02T17:11:39.413598Z",
     "iopub.status.idle": "2024-07-02T17:11:39.420623Z",
     "shell.execute_reply": "2024-07-02T17:11:39.419613Z"
    },
    "papermill": {
     "duration": 0.03601,
     "end_time": "2024-07-02T17:11:39.423796",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.387786",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "d1 4.0\n",
      "d2 4.0002\n",
      "slope 2.0000000000042206\n"
     ]
    }
   ],
   "source": [
    "h = 0.0001\n",
    "a = 2.0\n",
    "b = -3.0\n",
    "c = 10\n",
    "\n",
    "d1 = f2(a,b,c)\n",
    "b += h\n",
    "d2 = f2(a,b,c)\n",
    "\n",
    "print(\"d1\",d1)\n",
    "\n",
    "print(\"d2\",d2)\n",
    "print(\"slope\", (d2-d1)/h)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1e98079",
   "metadata": {
    "papermill": {
     "duration": 0.024605,
     "end_time": "2024-07-02T17:11:39.473121",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.448516",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Basic Building Block - Value\n",
    "\n",
    "- Take a single value and keep track of this value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fd744b99",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.524610Z",
     "iopub.status.busy": "2024-07-02T17:11:39.524197Z",
     "iopub.status.idle": "2024-07-02T17:11:39.575522Z",
     "shell.execute_reply": "2024-07-02T17:11:39.574493Z"
    },
    "papermill": {
     "duration": 0.080188,
     "end_time": "2024-07-02T17:11:39.578323",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.498135",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from graphviz import Digraph # Not going to discuss this since it's not the goal of this notebook. It's useful to visualize the network\n",
    "\n",
    "def trace(root):\n",
    "  # builds a set of all nodes and edges in a graph\n",
    "  nodes, edges = set(), set()\n",
    "  def build(v):\n",
    "    if v not in nodes:\n",
    "      nodes.add(v)\n",
    "      for child in v._prev:\n",
    "        edges.add((child, v))\n",
    "        build(child)\n",
    "  build(root)\n",
    "  return nodes, edges\n",
    "\n",
    "def draw_dot(root):\n",
    "  dot = Digraph(format='svg', graph_attr={'rankdir': 'LR'}) # LR = left to right\n",
    "  \n",
    "  nodes, edges = trace(root)\n",
    "  for n in nodes:\n",
    "    uid = str(id(n))\n",
    "    # for any value in the graph, create a rectangular ('record') node for it\n",
    "    dot.node(name = uid, label = \"{ %s | data %.4f | grad %.4f }\" % (n.label, n.data, n.grad), shape='record')\n",
    "    if n._op:\n",
    "      # if this value is a result of some operation, create an op node for it\n",
    "      dot.node(name = uid + n._op, label = n._op)\n",
    "      # and connect this node to it\n",
    "      dot.edge(uid + n._op, uid)\n",
    "\n",
    "  for n1, n2 in edges:\n",
    "    # connect n1 to the op node of n2\n",
    "    dot.edge(str(id(n1)), str(id(n2)) + n2._op)\n",
    "\n",
    "  return dot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ceaba2b9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.629215Z",
     "iopub.status.busy": "2024-07-02T17:11:39.628790Z",
     "iopub.status.idle": "2024-07-02T17:11:39.636130Z",
     "shell.execute_reply": "2024-07-02T17:11:39.634978Z"
    },
    "papermill": {
     "duration": 0.03626,
     "end_time": "2024-07-02T17:11:39.639250",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.602990",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "unsupported operand type(s) for +: 'Value' and 'Value'\n"
     ]
    }
   ],
   "source": [
    "class Value():\n",
    "    def __init__(self,data):\n",
    "        self.data = data\n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "a = Value(2)\n",
    "b = Value(-3)\n",
    "\n",
    "try:\n",
    "    a+b\n",
    "except Exception as e: print(e)    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a110db1b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.691801Z",
     "iopub.status.busy": "2024-07-02T17:11:39.691095Z",
     "iopub.status.idle": "2024-07-02T17:11:39.703681Z",
     "shell.execute_reply": "2024-07-02T17:11:39.702516Z"
    },
    "papermill": {
     "duration": 0.042245,
     "end_time": "2024-07-02T17:11:39.706580",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.664335",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "From previous Values {Value(data=-3), Value(data=2)} using *\n",
      "Value(data=-6)\n",
      "From previous Values {Value(data=10), Value(data=-6)} using +\n",
      "Value(data=4)\n",
      "From previous Values {Value(data=-2.0), Value(data=4)} using *\n",
      "Value(data=4)\n"
     ]
    }
   ],
   "source": [
    "# Value doesn't have an operations on 2 Values together so let's add it\n",
    "# _children() we can keep track of the previous values and _op to keep track of the operation to create current Value.\n",
    "# This _children() set we can use to back propagate later on\n",
    "# label \n",
    "\n",
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other): # Take in other Value class\n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        return out # \"Downstream node\"\n",
    "    \n",
    "    def __mul__(self,other): # Take in other Value class\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        return out # \"Downstream node\"\n",
    "    \n",
    "    \n",
    "a = Value(2, label = \"a\")\n",
    "b = Value(-3, label = \"b\")\n",
    "c = Value(10, label = \"c\")\n",
    "\n",
    "e = a*b; e.label = \"e\"\n",
    "\n",
    "print(f\"From previous Values {(e)._prev} using {(e)._op}\")\n",
    "print(e)\n",
    "\n",
    "d = e + c; d.label = \"d\"\n",
    "print(f\"From previous Values {d._prev} using {d._op}\")\n",
    "print(d)\n",
    "\n",
    "f = Value(-2.0, label = \"f\")\n",
    "L = d*f; L.label = \"L\"\n",
    "\n",
    "print(f\"From previous Values {L._prev} using {L._op}\")\n",
    "print(d)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7ee71e01",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:39.757927Z",
     "iopub.status.busy": "2024-07-02T17:11:39.757483Z",
     "iopub.status.idle": "2024-07-02T17:11:40.016901Z",
     "shell.execute_reply": "2024-07-02T17:11:40.015484Z"
    },
    "papermill": {
     "duration": 0.288517,
     "end_time": "2024-07-02T17:11:40.019822",
     "exception": false,
     "start_time": "2024-07-02T17:11:39.731305",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1321pt\" height=\"154pt\"\n",
       " viewBox=\"0.00 0.00 1321.25 154.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 150)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-150 1317.25,-150 1317.25,4 -4,4\"/>\n",
       "<!-- 140507647736464 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647736464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"723,-109.5 723,-145.5 953.25,-145.5 953.25,-109.5 723,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"733.62\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"744.25,-110.25 744.25,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"797.25\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"850.25,-110.25 850.25,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"901.75\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647736560*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1016.25\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1016.25\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647736464&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647736464&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M953.65,-109.29C962.36,-107.91 970.69,-106.58 978.25,-105.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"978.62,-108.87 987.95,-103.84 977.53,-101.95 978.62,-108.87\"/>\n",
       "</g>\n",
       "<!-- 140507647736992 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647736992</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"360,-82.5 360,-118.5 597,-118.5 597,-82.5 360,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"371.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"383.5,-83.25 383.5,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"438.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"494,-83.25 494,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"545.5\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647736512+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"660\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"660\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647736992&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647736992&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M597.48,-82.1C606.21,-80.73 614.54,-79.43 622.1,-78.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"622.44,-81.74 631.79,-76.75 621.37,-74.83 622.44,-81.74\"/>\n",
       "</g>\n",
       "<!-- 140507647736512 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647736512</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"723.38,-54.5 723.38,-90.5 952.88,-90.5 952.88,-54.5 723.38,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"735.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"748.38,-55.25 748.38,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"799.12\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"849.88,-55.25 849.88,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"901.38\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647736512&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M953.15,-89.98C962.01,-91.34 970.48,-92.64 978.16,-93.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"977.61,-97.27 988.02,-95.33 978.67,-90.35 977.61,-97.27\"/>\n",
       "</g>\n",
       "<!-- 140507647736512+&#45;&gt;140507647736512 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647736512+&#45;&gt;140507647736512</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M687.37,-72.5C694.6,-72.5 702.95,-72.5 711.92,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"711.64,-76 721.64,-72.5 711.64,-69 711.64,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647736560 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647736560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1079.25,-81.5 1079.25,-117.5 1313.25,-117.5 1313.25,-81.5 1079.25,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1091.75\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1104.25,-82.25 1104.25,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1157.25\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1210.25,-82.25 1210.25,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1261.75\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560*&#45;&gt;140507647736560 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647736560*&#45;&gt;140507647736560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1043.51,-99.5C1050.59,-99.5 1058.73,-99.5 1067.5,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1067.4,-103 1077.4,-99.5 1067.4,-96 1067.4,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647737088 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647737088</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 234,-91.5 234,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"25,-56.25 25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"78\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"131,-56.25 131,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"182.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656* -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647736656*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"297\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"297\" y=\"-40.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647737088&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737088&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.24,-55.21C243.07,-53.83 251.51,-52.5 259.15,-51.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.62,-54.77 268.96,-49.75 258.53,-47.85 259.62,-54.77\"/>\n",
       "</g>\n",
       "<!-- 140507647736656 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647736656</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"361.88,-27.5 361.88,-63.5 595.12,-63.5 595.12,-27.5 361.88,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"374\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"386.12,-28.25 386.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"439.12\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"492.12,-28.25 492.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"543.62\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647736656&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M595.46,-62.94C604.91,-64.36 613.94,-65.72 622.06,-66.94\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"621.37,-70.38 631.78,-68.41 622.41,-63.46 621.37,-70.38\"/>\n",
       "</g>\n",
       "<!-- 140507647736656*&#45;&gt;140507647736656 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647736656*&#45;&gt;140507647736656</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324.49,-45.5C332.06,-45.5 340.85,-45.5 350.32,-45.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"350.2,-49 360.2,-45.5 350.2,-42 350.2,-49\"/>\n",
       "</g>\n",
       "<!-- 140507647737184 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737184</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.62,-0.5 2.62,-36.5 231.38,-36.5 231.38,-0.5 2.62,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"14.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"26.88,-1.25 26.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"77.62\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"128.38,-1.25 128.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"179.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737184&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647737184&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M231.74,-35.75C241.46,-37.23 250.76,-38.64 259.11,-39.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"258.33,-43.33 268.74,-41.37 259.38,-36.4 258.33,-43.33\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e4790>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "draw_dot(L)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5353a940",
   "metadata": {
    "papermill": {
     "duration": 0.025044,
     "end_time": "2024-07-02T17:11:40.072311",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.047267",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Manually back propagation - step by step calculation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "778cecbb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:40.125731Z",
     "iopub.status.busy": "2024-07-02T17:11:40.125308Z",
     "iopub.status.idle": "2024-07-02T17:11:40.155973Z",
     "shell.execute_reply": "2024-07-02T17:11:40.154820Z"
    },
    "papermill": {
     "duration": 0.061039,
     "end_time": "2024-07-02T17:11:40.158730",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.097691",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1321pt\" height=\"154pt\"\n",
       " viewBox=\"0.00 0.00 1321.25 154.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 150)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-150 1317.25,-150 1317.25,4 -4,4\"/>\n",
       "<!-- 140507647736464 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647736464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"723,-109.5 723,-145.5 953.25,-145.5 953.25,-109.5 723,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"733.62\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"744.25,-110.25 744.25,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"797.25\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"850.25,-110.25 850.25,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"901.75\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647736560*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1016.25\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1016.25\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647736464&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647736464&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M953.65,-109.29C962.36,-107.91 970.69,-106.58 978.25,-105.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"978.62,-108.87 987.95,-103.84 977.53,-101.95 978.62,-108.87\"/>\n",
       "</g>\n",
       "<!-- 140507647736992 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647736992</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"360,-82.5 360,-118.5 597,-118.5 597,-82.5 360,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"371.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"383.5,-83.25 383.5,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"438.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"494,-83.25 494,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"545.5\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647736512+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"660\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"660\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647736992&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647736992&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M597.48,-82.1C606.21,-80.73 614.54,-79.43 622.1,-78.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"622.44,-81.74 631.79,-76.75 621.37,-74.83 622.44,-81.74\"/>\n",
       "</g>\n",
       "<!-- 140507647736512 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647736512</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"723.38,-54.5 723.38,-90.5 952.88,-90.5 952.88,-54.5 723.38,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"735.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"748.38,-55.25 748.38,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"799.12\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"849.88,-55.25 849.88,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"901.38\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647736512&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M953.15,-89.98C962.01,-91.34 970.48,-92.64 978.16,-93.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"977.61,-97.27 988.02,-95.33 978.67,-90.35 977.61,-97.27\"/>\n",
       "</g>\n",
       "<!-- 140507647736512+&#45;&gt;140507647736512 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647736512+&#45;&gt;140507647736512</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M687.37,-72.5C694.6,-72.5 702.95,-72.5 711.92,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"711.64,-76 721.64,-72.5 711.64,-69 711.64,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647736560 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647736560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1079.25,-81.5 1079.25,-117.5 1313.25,-117.5 1313.25,-81.5 1079.25,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1091.75\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1104.25,-82.25 1104.25,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1157.25\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1210.25,-82.25 1210.25,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1261.75\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560*&#45;&gt;140507647736560 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647736560*&#45;&gt;140507647736560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1043.51,-99.5C1050.59,-99.5 1058.73,-99.5 1067.5,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1067.4,-103 1077.4,-99.5 1067.4,-96 1067.4,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647737088 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647737088</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 234,-91.5 234,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"25,-56.25 25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"78\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"131,-56.25 131,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"182.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656* -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647736656*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"297\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"297\" y=\"-40.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647737088&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737088&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.24,-55.21C243.07,-53.83 251.51,-52.5 259.15,-51.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.62,-54.77 268.96,-49.75 258.53,-47.85 259.62,-54.77\"/>\n",
       "</g>\n",
       "<!-- 140507647736656 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647736656</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"361.88,-27.5 361.88,-63.5 595.12,-63.5 595.12,-27.5 361.88,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"374\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"386.12,-28.25 386.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"439.12\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"492.12,-28.25 492.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"543.62\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647736656&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M595.46,-62.94C604.91,-64.36 613.94,-65.72 622.06,-66.94\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"621.37,-70.38 631.78,-68.41 622.41,-63.46 621.37,-70.38\"/>\n",
       "</g>\n",
       "<!-- 140507647736656*&#45;&gt;140507647736656 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647736656*&#45;&gt;140507647736656</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324.49,-45.5C332.06,-45.5 340.85,-45.5 350.32,-45.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"350.2,-49 360.2,-45.5 350.2,-42 350.2,-49\"/>\n",
       "</g>\n",
       "<!-- 140507647737184 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737184</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.62,-0.5 2.62,-36.5 231.38,-36.5 231.38,-0.5 2.62,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"14.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"26.88,-1.25 26.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"77.62\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"128.38,-1.25 128.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"179.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737184&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647737184&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M231.74,-35.75C241.46,-37.23 250.76,-38.64 259.11,-39.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"258.33,-43.33 268.74,-41.37 259.38,-36.4 258.33,-43.33\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e5120>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Derivative of L with respect to L is 1 -  (L + h - L)/h = 1\n",
    "\n",
    "L.grad = 1\n",
    "draw_dot(L)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dd9e49f7",
   "metadata": {
    "papermill": {
     "duration": 0.025419,
     "end_time": "2024-07-02T17:11:40.210273",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.184854",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "What's derivative of L with respect to d - dL/dd?\n",
    "\n",
    "We can calculate this by following the derivative definition above and vice versa\n",
    "\n",
    "\\begin{equation}\\frac{dL}{dd} = \\frac{(d+h)^*f~-~d^*f}h~=~\\frac{d^*f~+~h^*f~-d^*f}h~=~f\\end{equation}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "c34d3aa7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:40.264238Z",
     "iopub.status.busy": "2024-07-02T17:11:40.263843Z",
     "iopub.status.idle": "2024-07-02T17:11:40.294785Z",
     "shell.execute_reply": "2024-07-02T17:11:40.293528Z"
    },
    "papermill": {
     "duration": 0.060791,
     "end_time": "2024-07-02T17:11:40.297174",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.236383",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1325pt\" height=\"154pt\"\n",
       " viewBox=\"0.00 0.00 1325.00 154.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 150)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-150 1321,-150 1321,4 -4,4\"/>\n",
       "<!-- 140507647736464 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647736464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"724.88,-109.5 724.88,-145.5 955.12,-145.5 955.12,-109.5 724.88,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"735.5\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"746.12,-110.25 746.12,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"799.12\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"852.12,-110.25 852.12,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"903.62\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 4.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647736560*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1020\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1020\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647736464&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647736464&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M955.49,-109.49C964.92,-108.01 973.94,-106.59 982.06,-105.31\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"982.44,-108.79 991.77,-103.78 981.35,-101.88 982.44,-108.79\"/>\n",
       "</g>\n",
       "<!-- 140507647736992 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647736992</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"360,-82.5 360,-118.5 597,-118.5 597,-82.5 360,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"371.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"383.5,-83.25 383.5,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"438.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"494,-83.25 494,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"545.5\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647736512+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"660\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"660\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647736992&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647736992&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M597.48,-82.1C606.21,-80.73 614.54,-79.43 622.1,-78.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"622.44,-81.74 631.79,-76.75 621.37,-74.83 622.44,-81.74\"/>\n",
       "</g>\n",
       "<!-- 140507647736512 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647736512</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"723,-54.5 723,-90.5 957,-90.5 957,-54.5 723,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"735.5\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"748,-55.25 748,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"798.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"849.5,-55.25 849.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"903.25\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647736512&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M957.24,-90.13C965.99,-91.46 974.34,-92.73 981.93,-93.88\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"981.24,-97.31 991.66,-95.35 982.29,-90.39 981.24,-97.31\"/>\n",
       "</g>\n",
       "<!-- 140507647736512+&#45;&gt;140507647736512 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647736512+&#45;&gt;140507647736512</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M687.26,-72.5C694.34,-72.5 702.48,-72.5 711.25,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"711.15,-76 721.15,-72.5 711.15,-69 711.15,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647736560 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647736560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1083,-81.5 1083,-117.5 1317,-117.5 1317,-81.5 1083,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1095.5\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1108,-82.25 1108,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1161\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1214,-82.25 1214,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1265.5\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560*&#45;&gt;140507647736560 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647736560*&#45;&gt;140507647736560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1047.26,-99.5C1054.34,-99.5 1062.48,-99.5 1071.25,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1071.15,-103 1081.15,-99.5 1071.15,-96 1071.15,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647737088 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647737088</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 234,-91.5 234,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"25,-56.25 25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"78\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"131,-56.25 131,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"182.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656* -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647736656*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"297\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"297\" y=\"-40.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647737088&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737088&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.24,-55.21C243.07,-53.83 251.51,-52.5 259.15,-51.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.62,-54.77 268.96,-49.75 258.53,-47.85 259.62,-54.77\"/>\n",
       "</g>\n",
       "<!-- 140507647736656 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647736656</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"361.88,-27.5 361.88,-63.5 595.12,-63.5 595.12,-27.5 361.88,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"374\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"386.12,-28.25 386.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"439.12\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"492.12,-28.25 492.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"543.62\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647736656&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M595.46,-62.94C604.91,-64.36 613.94,-65.72 622.06,-66.94\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"621.37,-70.38 631.78,-68.41 622.41,-63.46 621.37,-70.38\"/>\n",
       "</g>\n",
       "<!-- 140507647736656*&#45;&gt;140507647736656 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647736656*&#45;&gt;140507647736656</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324.49,-45.5C332.06,-45.5 340.85,-45.5 350.32,-45.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"350.2,-49 360.2,-45.5 350.2,-42 350.2,-49\"/>\n",
       "</g>\n",
       "<!-- 140507647737184 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737184</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.62,-0.5 2.62,-36.5 231.38,-36.5 231.38,-0.5 2.62,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"14.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"26.88,-1.25 26.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"77.62\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"128.38,-1.25 128.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"179.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737184&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647737184&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M231.74,-35.75C241.46,-37.23 250.76,-38.64 259.11,-39.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"258.33,-43.33 268.74,-41.37 259.38,-36.4 258.33,-43.33\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e5420>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f.grad = d.data  # d = 4\n",
    "d.grad = f.data  # f = -2\n",
    "\n",
    "draw_dot(L)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "376ef3f8",
   "metadata": {
    "papermill": {
     "duration": 0.08652,
     "end_time": "2024-07-02T17:11:40.410056",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.323536",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "How do we calculate dL/de ? We can use the chain rule\n",
    "\n",
    "\\begin{equation}\\frac{dL}{de}=\\frac{dL}{dd}\\times\\frac{dd}{de}\\end{equation}\n",
    "\n",
    "and what's dd/de ?\n",
    "\\begin{equation}\\frac{dd}{de}~=~\\frac{(e+c+h)~-~(e+c)}h~=~\\frac hh~=~1\\end{equation}\n",
    "\n",
    "so \\begin{equation}\\frac{dL}{de}= \\frac{dL}{dd} = -2 \\end{equation}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "424adffe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:40.464506Z",
     "iopub.status.busy": "2024-07-02T17:11:40.464097Z",
     "iopub.status.idle": "2024-07-02T17:11:40.495057Z",
     "shell.execute_reply": "2024-07-02T17:11:40.493866Z"
    },
    "papermill": {
     "duration": 0.061675,
     "end_time": "2024-07-02T17:11:40.498080",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.436405",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1330pt\" height=\"154pt\"\n",
       " viewBox=\"0.00 0.00 1329.50 154.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 150)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-150 1325.5,-150 1325.5,4 -4,4\"/>\n",
       "<!-- 140507647736464 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647736464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"729.38,-109.5 729.38,-145.5 959.62,-145.5 959.62,-109.5 729.38,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"740\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"750.62,-110.25 750.62,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"803.62\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"856.62,-110.25 856.62,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"908.12\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 4.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647736560*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1024.5\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1024.5\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647736464&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647736464&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M959.99,-109.49C969.42,-108.01 978.44,-106.59 986.56,-105.31\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"986.94,-108.79 996.27,-103.78 985.85,-101.88 986.94,-108.79\"/>\n",
       "</g>\n",
       "<!-- 140507647736992 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647736992</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"360,-82.5 360,-118.5 601.5,-118.5 601.5,-82.5 360,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"371.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"383.5,-83.25 383.5,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"438.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"494,-83.25 494,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"547.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647736512+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"664.5\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"664.5\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647736992&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647736992&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M601.71,-82.02C610.49,-80.67 618.87,-79.38 626.46,-78.21\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"626.85,-81.69 636.2,-76.71 625.78,-74.77 626.85,-81.69\"/>\n",
       "</g>\n",
       "<!-- 140507647736512 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647736512</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"727.5,-54.5 727.5,-90.5 961.5,-90.5 961.5,-54.5 727.5,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"740\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"752.5,-55.25 752.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"803.25\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"854,-55.25 854,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"907.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647736512&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M961.74,-90.13C970.49,-91.46 978.84,-92.73 986.43,-93.88\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"985.74,-97.31 996.16,-95.35 986.79,-90.39 985.74,-97.31\"/>\n",
       "</g>\n",
       "<!-- 140507647736512+&#45;&gt;140507647736512 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647736512+&#45;&gt;140507647736512</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M691.76,-72.5C698.84,-72.5 706.98,-72.5 715.75,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"715.65,-76 725.65,-72.5 715.65,-69 715.65,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647736560 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647736560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1087.5,-81.5 1087.5,-117.5 1321.5,-117.5 1321.5,-81.5 1087.5,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1100\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1112.5,-82.25 1112.5,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1165.5\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1218.5,-82.25 1218.5,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1270\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560*&#45;&gt;140507647736560 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647736560*&#45;&gt;140507647736560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1051.76,-99.5C1058.84,-99.5 1066.98,-99.5 1075.75,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1075.65,-103 1085.65,-99.5 1075.65,-96 1075.65,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647737088 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647737088</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 234,-91.5 234,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"25,-56.25 25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"78\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"131,-56.25 131,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"182.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656* -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647736656*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"297\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"297\" y=\"-40.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647737088&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737088&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.24,-55.21C243.07,-53.83 251.51,-52.5 259.15,-51.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.62,-54.77 268.96,-49.75 258.53,-47.85 259.62,-54.77\"/>\n",
       "</g>\n",
       "<!-- 140507647736656 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647736656</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"361.88,-27.5 361.88,-63.5 599.62,-63.5 599.62,-27.5 361.88,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"374\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"386.12,-28.25 386.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"439.12\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"492.12,-28.25 492.12,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"545.88\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647736656&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M599.93,-63.06C609.41,-64.46 618.45,-65.81 626.58,-67.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"625.89,-70.45 636.3,-68.46 626.92,-63.53 625.89,-70.45\"/>\n",
       "</g>\n",
       "<!-- 140507647736656*&#45;&gt;140507647736656 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647736656*&#45;&gt;140507647736656</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324.43,-45.5C332,-45.5 340.8,-45.5 350.29,-45.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"350.2,-49 360.2,-45.5 350.2,-42 350.2,-49\"/>\n",
       "</g>\n",
       "<!-- 140507647737184 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737184</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.62,-0.5 2.62,-36.5 231.38,-36.5 231.38,-0.5 2.62,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"14.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"26.88,-1.25 26.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"77.62\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"128.38,-1.25 128.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"179.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737184&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647737184&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M231.74,-35.75C241.46,-37.23 250.76,-38.64 259.11,-39.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"258.33,-43.33 268.74,-41.37 259.38,-36.4 258.33,-43.33\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e56f0>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "c.grad = d.grad * 1.0 # 1 is dL/dL\n",
    "e.grad = d.grad * 1.0 # 1 is dL/dL\n",
    "draw_dot(L)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca15d2f3",
   "metadata": {
    "papermill": {
     "duration": 0.026539,
     "end_time": "2024-07-02T17:11:40.551679",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.525140",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Now we can apply the chain rule once again to find dL/da\n",
    "\n",
    "\\begin{equation}\\frac{dL}{da}=\\frac{dL}{dd}\\times\\frac{dd}{de}\\times\\frac{de}{da}\\end{equation}\n",
    "\n",
    "The only unknow here id de/da\n",
    "\n",
    "\\begin{equation}\\frac{de}{da} = \\frac{(a+h)^*b~-~a^*b}h~=~\\frac{a^*b~+~h^*b~-a^*b}h~=~b\\end{equation}\n",
    "\n",
    "\\begin{equation}\\frac{dL}{da}=f \\times1 \\times b = -6 \\end{equation}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "1c1a5bdf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:40.606742Z",
     "iopub.status.busy": "2024-07-02T17:11:40.606337Z",
     "iopub.status.idle": "2024-07-02T17:11:40.637319Z",
     "shell.execute_reply": "2024-07-02T17:11:40.636097Z"
    },
    "papermill": {
     "duration": 0.061415,
     "end_time": "2024-07-02T17:11:40.639830",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.578415",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1334pt\" height=\"154pt\"\n",
       " viewBox=\"0.00 0.00 1334.00 154.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 150)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-150 1330,-150 1330,4 -4,4\"/>\n",
       "<!-- 140507647736464 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647736464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"733.88,-109.5 733.88,-145.5 964.12,-145.5 964.12,-109.5 733.88,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"744.5\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"755.12,-110.25 755.12,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"808.12\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"861.12,-110.25 861.12,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"912.62\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 4.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647736560*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1029\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1029\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647736464&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647736464&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M964.49,-109.49C973.92,-108.01 982.94,-106.59 991.06,-105.31\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"991.44,-108.79 1000.77,-103.78 990.35,-101.88 991.44,-108.79\"/>\n",
       "</g>\n",
       "<!-- 140507647736992 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647736992</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"364.5,-82.5 364.5,-118.5 606,-118.5 606,-82.5 364.5,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"376.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"388,-83.25 388,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"443.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"498.5,-83.25 498.5,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"552.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647736512+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"669\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"669\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647736992&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647736992&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M606.21,-82.02C614.99,-80.67 623.37,-79.38 630.96,-78.21\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"631.35,-81.69 640.7,-76.71 630.28,-74.77 631.35,-81.69\"/>\n",
       "</g>\n",
       "<!-- 140507647736512 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647736512</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"732,-54.5 732,-90.5 966,-90.5 966,-54.5 732,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"744.5\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"757,-55.25 757,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"807.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"858.5,-55.25 858.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"912.25\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736512&#45;&gt;140507647736560* -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647736512&#45;&gt;140507647736560*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M966.24,-90.13C974.99,-91.46 983.34,-92.73 990.93,-93.88\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"990.24,-97.31 1000.66,-95.35 991.29,-90.39 990.24,-97.31\"/>\n",
       "</g>\n",
       "<!-- 140507647736512+&#45;&gt;140507647736512 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647736512+&#45;&gt;140507647736512</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M696.26,-72.5C703.34,-72.5 711.48,-72.5 720.25,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"720.15,-76 730.15,-72.5 720.15,-69 720.15,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647736560 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647736560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1092,-81.5 1092,-117.5 1326,-117.5 1326,-81.5 1092,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1104.5\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1117,-82.25 1117,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1170\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1223,-82.25 1223,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1274.5\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736560*&#45;&gt;140507647736560 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647736560*&#45;&gt;140507647736560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1056.26,-99.5C1063.34,-99.5 1071.48,-99.5 1080.25,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1080.15,-103 1090.15,-99.5 1080.15,-96 1080.15,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647737088 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647737088</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 238.5,-91.5 238.5,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"25,-56.25 25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"78\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"131,-56.25 131,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"184.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;4.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656* -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647736656*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"301.5\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"301.5\" y=\"-40.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647737088&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737088&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M238.97,-55.06C247.71,-53.7 256.05,-52.41 263.61,-51.23\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"263.95,-54.72 273.29,-49.73 262.88,-47.8 263.95,-54.72\"/>\n",
       "</g>\n",
       "<!-- 140507647736656 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647736656</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"366.38,-27.5 366.38,-63.5 604.12,-63.5 604.12,-27.5 366.38,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"378.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"390.62,-28.25 390.62,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"443.62\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"496.62,-28.25 496.62,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"550.38\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647736656&#45;&gt;140507647736512+ -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647736656&#45;&gt;140507647736512+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M604.43,-63.06C613.91,-64.46 622.95,-65.81 631.08,-67.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"630.39,-70.45 640.8,-68.46 631.42,-63.53 630.39,-70.45\"/>\n",
       "</g>\n",
       "<!-- 140507647736656*&#45;&gt;140507647736656 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647736656*&#45;&gt;140507647736656</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M328.93,-45.5C336.5,-45.5 345.3,-45.5 354.79,-45.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"354.7,-49 364.7,-45.5 354.7,-42 354.7,-49\"/>\n",
       "</g>\n",
       "<!-- 140507647737184 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737184</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.88,-0.5 4.88,-36.5 233.62,-36.5 233.62,-0.5 4.88,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"17\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"29.12,-1.25 29.12,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"79.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"130.62,-1.25 130.62,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"182.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 6.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737184&#45;&gt;140507647736656* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647737184&#45;&gt;140507647736656*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M233.89,-35.52C244.45,-37.1 254.55,-38.62 263.54,-39.96\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"262.78,-43.39 273.18,-41.41 263.81,-36.47 262.78,-43.39\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e40a0>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a.grad = b.data * f.data\n",
    "b.grad = a.data * f.data\n",
    "draw_dot(L)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "59095a1f",
   "metadata": {
    "papermill": {
     "duration": 0.027148,
     "end_time": "2024-07-02T17:11:40.694621",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.667473",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Observation:\n",
    "\n",
    "- In the leaf node with the \"+\" operator, the gradient is equal to the previous node's gradient\n",
    "- In the leaf node with the \"*\" operator, in the example of the leaf node a's gradient =  b.data * e.grad and leaf node b gradient = a.data * e.grad"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69945005",
   "metadata": {
    "papermill": {
     "duration": 0.026685,
     "end_time": "2024-07-02T17:11:40.748847",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.722162",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Backpropagation through a neuron"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bbf20efe",
   "metadata": {
    "papermill": {
     "duration": 0.026691,
     "end_time": "2024-07-02T17:11:40.802847",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.776156",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Create a simple neuron"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8bb50e47",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-21T18:22:21.936565Z",
     "iopub.status.busy": "2024-06-21T18:22:21.936123Z",
     "iopub.status.idle": "2024-06-21T18:22:21.944404Z",
     "shell.execute_reply": "2024-06-21T18:22:21.942747Z",
     "shell.execute_reply.started": "2024-06-21T18:22:21.936528Z"
    },
    "papermill": {
     "duration": 0.027281,
     "end_time": "2024-07-02T17:11:40.857730",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.830449",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p align=\"center\">\n",
    "  <img src=\"https://miro.medium.com/v2/resize:fit:1400/1*T4ARzySpEQvEnr_9pc78pg.jpeg\" width = \"500\" />\n",
    "</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c6f4090",
   "metadata": {
    "papermill": {
     "duration": 0.029025,
     "end_time": "2024-07-02T17:11:40.913997",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.884972",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- What's activation function ?\n",
    "\n",
    "Activation functions help map input values to a known range, which helps stabilize training and helps map values to a desired output\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8720d264",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:40.970327Z",
     "iopub.status.busy": "2024-07-02T17:11:40.969935Z",
     "iopub.status.idle": "2024-07-02T17:11:40.982322Z",
     "shell.execute_reply": "2024-07-02T17:11:40.981116Z"
    },
    "papermill": {
     "duration": 0.043506,
     "end_time": "2024-07-02T17:11:40.984920",
     "exception": false,
     "start_time": "2024-07-02T17:11:40.941414",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# The Value class doesn't have the activation function yet so let's implement it, in this case tanh function\n",
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other):\n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        return out\n",
    "    \n",
    "    def __mul__(self,other):\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        return out\n",
    "    \n",
    "    def tanh(self):\n",
    "        x = self.data \n",
    "        t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1) # Calculating tanh\n",
    "        out = Value(t, (self, ), 'tanh') \n",
    "        return out # Downstream node"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "ac4eebd7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.041798Z",
     "iopub.status.busy": "2024-07-02T17:11:41.040970Z",
     "iopub.status.idle": "2024-07-02T17:11:41.078494Z",
     "shell.execute_reply": "2024-07-02T17:11:41.077376Z"
    },
    "papermill": {
     "duration": 0.069262,
     "end_time": "2024-07-02T17:11:41.081387",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.012125",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647733776 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647733776</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-165.5 0,-201.5 246,-201.5 246,-165.5 0,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-166.25 37,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-166.25 143,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737712* -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647737712*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647733776&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647733776&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647729696 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647729696</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735456+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647735456+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647729696&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647729696&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "<!-- 140507647735456 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647735456</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647735024tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647735456&#45;&gt;140507647735024tanh -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735456&#45;&gt;140507647735024tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735456+&#45;&gt;140507647735456 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647735456+&#45;&gt;140507647735456</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735024 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647735024</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh&#45;&gt;140507647735024 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647735024tanh&#45;&gt;140507647735024</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647722736 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647722736</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280* -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647737280*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647722736&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647722736&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647729408 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647729408</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-110.5 4.12,-146.5 241.88,-146.5 241.88,-110.5 4.12,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-111.25 37.38,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-111.25 138.88,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647729408&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647729408&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M242.35,-128.5C252.31,-128.5 261.82,-128.5 270.35,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-132 280.2,-128.5 270.2,-125 270.2,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647735648 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647735648</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735648&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647735648&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647737712 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737712</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724464+ -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647724464+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647737712&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647737712&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647737712*&#45;&gt;140507647737712 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647737712*&#45;&gt;140507647737712</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724464 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724464&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724464&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647724464+&#45;&gt;140507647724464 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724464+&#45;&gt;140507647724464</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647737280 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647737280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647737280&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647737280*&#45;&gt;140507647737280 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737280*&#45;&gt;140507647737280</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e7400>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Input\n",
    "x1 = Value(2.0, label = \"x1\")\n",
    "x2 = Value(0.0, label = \"x2\")\n",
    "\n",
    "#Weight\n",
    "w1 = Value(-3.0, label = \"w1\")\n",
    "w2 = Value(1.0,  label = \"w2\")\n",
    "\n",
    "#Bias\n",
    "b = Value(6.8813735870195432, label='b') # The number is chosen to get a \"nice\" looking output later on\n",
    "\n",
    "# Sum of inputs * weights + bias\n",
    "x1w1 = x1*w1; x1w1.label = \"x1w1\"\n",
    "x2w2 = x2*w2; x2w2.label = \"x2w2\"\n",
    "x1w1x2w2 = x1w1 + x2w2; x1w1x2w2.label = \"x1w1 + x2w2\"\n",
    "neuron = x1w1x2w2 + b; neuron.label = \"neuron\"\n",
    "output = neuron.tanh(); output.label = \"output\"\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "38711567",
   "metadata": {
    "papermill": {
     "duration": 0.027947,
     "end_time": "2024-07-02T17:11:41.137927",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.109980",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Manually Backpropagate through the neuron"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "57ebaea8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.195874Z",
     "iopub.status.busy": "2024-07-02T17:11:41.195433Z",
     "iopub.status.idle": "2024-07-02T17:11:41.200380Z",
     "shell.execute_reply": "2024-07-02T17:11:41.199249Z"
    },
    "papermill": {
     "duration": 0.03696,
     "end_time": "2024-07-02T17:11:41.202667",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.165707",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Similar to previous example of L, the derivate of the output with respect to itself is 1\n",
    "output.grad = 1.0"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "332cc02d",
   "metadata": {
    "papermill": {
     "duration": 0.02748,
     "end_time": "2024-07-02T17:11:41.258315",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.230835",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "How do we calculate the gradient for neuron ?\n",
    "\n",
    "We do have the formula to calculate the derivate for tanh\n",
    "\n",
    "\\begin{equation}\\frac{d}{dx}\\operatorname{tanh}x=1-\\operatorname{tanh}^{2}x\\end{equation}\n",
    "\n",
    "where **tanh x** is the **output.data**. The gradient of the neuron would be:\n",
    "\n",
    "\\begin{equation}\\begin{aligned}\\frac{d  output .data}{d  neuron.data} = 1 - (output.data)^2\\end{aligned}\\end{equation}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "eedbbb13",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.315619Z",
     "iopub.status.busy": "2024-07-02T17:11:41.314638Z",
     "iopub.status.idle": "2024-07-02T17:11:41.345676Z",
     "shell.execute_reply": "2024-07-02T17:11:41.344456Z"
    },
    "papermill": {
     "duration": 0.06242,
     "end_time": "2024-07-02T17:11:41.348287",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.285867",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647733776 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647733776</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-165.5 0,-201.5 246,-201.5 246,-165.5 0,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-166.25 37,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-166.25 143,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737712* -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647737712*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647733776&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647733776&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647729696 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647729696</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735456+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647735456+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647729696&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647729696&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "<!-- 140507647735456 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647735456</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647735024tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647735456&#45;&gt;140507647735024tanh -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735456&#45;&gt;140507647735024tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735456+&#45;&gt;140507647735456 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647735456+&#45;&gt;140507647735456</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735024 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647735024</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh&#45;&gt;140507647735024 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647735024tanh&#45;&gt;140507647735024</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647722736 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647722736</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280* -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647737280*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647722736&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647722736&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647729408 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647729408</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-110.5 4.12,-146.5 241.88,-146.5 241.88,-110.5 4.12,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-111.25 37.38,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-111.25 138.88,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647729408&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647729408&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M242.35,-128.5C252.31,-128.5 261.82,-128.5 270.35,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-132 280.2,-128.5 270.2,-125 270.2,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647735648 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647735648</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735648&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647735648&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647737712 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737712</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724464+ -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647724464+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647737712&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647737712&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647737712*&#45;&gt;140507647737712 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647737712*&#45;&gt;140507647737712</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724464 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724464&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724464&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647724464+&#45;&gt;140507647724464 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724464+&#45;&gt;140507647724464</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647737280 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647737280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647737280&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647737280*&#45;&gt;140507647737280 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737280*&#45;&gt;140507647737280</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e7070>"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neuron.grad = (1 - output.data ** 2) * output.grad #Include output.grad for completness, can't forget the chain rule \n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ca494df3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.407882Z",
     "iopub.status.busy": "2024-07-02T17:11:41.407459Z",
     "iopub.status.idle": "2024-07-02T17:11:41.439329Z",
     "shell.execute_reply": "2024-07-02T17:11:41.438191Z"
    },
    "papermill": {
     "duration": 0.064464,
     "end_time": "2024-07-02T17:11:41.442057",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.377593",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647733776 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647733776</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-165.5 0,-201.5 246,-201.5 246,-165.5 0,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-166.25 37,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-166.25 143,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737712* -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647737712*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647733776&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647733776&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647729696 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647729696</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735456+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647735456+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647729696&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647729696&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "<!-- 140507647735456 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647735456</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647735024tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647735456&#45;&gt;140507647735024tanh -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735456&#45;&gt;140507647735024tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735456+&#45;&gt;140507647735456 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647735456+&#45;&gt;140507647735456</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735024 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647735024</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh&#45;&gt;140507647735024 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647735024tanh&#45;&gt;140507647735024</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647722736 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647722736</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280* -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647737280*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647722736&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647722736&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647729408 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647729408</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-110.5 4.12,-146.5 241.88,-146.5 241.88,-110.5 4.12,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-111.25 37.38,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-111.25 138.88,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647729408&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647729408&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M242.35,-128.5C252.31,-128.5 261.82,-128.5 270.35,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-132 280.2,-128.5 270.2,-125 270.2,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647735648 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647735648</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735648&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647735648&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647737712 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737712</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724464+ -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647724464+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647737712&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647737712&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647737712*&#45;&gt;140507647737712 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647737712*&#45;&gt;140507647737712</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724464 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724464&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724464&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647724464+&#45;&gt;140507647724464 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724464+&#45;&gt;140507647724464</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647737280 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647737280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647737280&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647737280&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647737280*&#45;&gt;140507647737280 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737280*&#45;&gt;140507647737280</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e5ea0>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Gradient for b and x1w1 + x2w2 is similar to c and e in the previous example with the \"+\" operator\n",
    "b.grad = neuron.grad\n",
    "x1w1x2w2.grad = neuron.grad\n",
    "\n",
    "# Similarily to x1w1 and x2w2 with the \"+\" operator\n",
    "x1w1.grad = x1w1x2w2.grad\n",
    "x2w2.grad = x1w1x2w2.grad\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "ca3b13c8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.501964Z",
     "iopub.status.busy": "2024-07-02T17:11:41.501529Z",
     "iopub.status.idle": "2024-07-02T17:11:41.533519Z",
     "shell.execute_reply": "2024-07-02T17:11:41.532475Z"
    },
    "papermill": {
     "duration": 0.064927,
     "end_time": "2024-07-02T17:11:41.536055",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.471128",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647733776 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647733776</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-165.5 0,-201.5 246,-201.5 246,-165.5 0,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-166.25 37,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-166.25 143,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737712* -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647737712*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647733776&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647733776&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647729696 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647729696</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735456+ -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647735456+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647729696&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647729696&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "<!-- 140507647735456 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647735456</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647735024tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647735456&#45;&gt;140507647735024tanh -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735456&#45;&gt;140507647735024tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735456+&#45;&gt;140507647735456 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647735456+&#45;&gt;140507647735456</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647735024 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647735024</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647735024tanh&#45;&gt;140507647735024 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647735024tanh&#45;&gt;140507647735024</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647722736 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647722736</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280* -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647737280*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647722736&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647722736&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647729408 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647729408</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1.88,-110.5 1.88,-146.5 244.12,-146.5 244.12,-110.5 1.88,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"35.12,-111.25 35.12,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"85.88\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.62,-111.25 136.62,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n",
       "</g>\n",
       "<!-- 140507647729408&#45;&gt;140507647737712* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647729408&#45;&gt;140507647737712*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.42,-128.5C253.63,-128.5 262.41,-128.5 270.36,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-132 280.2,-128.5 270.2,-125 270.2,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647735648 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647735648</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647735648&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647735648&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647737712 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647737712</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724464+ -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647724464+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647737712&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647737712&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647737712*&#45;&gt;140507647737712 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647737712*&#45;&gt;140507647737712</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724464 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724464</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724464&#45;&gt;140507647735456+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724464&#45;&gt;140507647735456+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647724464+&#45;&gt;140507647724464 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724464+&#45;&gt;140507647724464</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647737280 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647737280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647737280&#45;&gt;140507647724464+ -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647737280&#45;&gt;140507647724464+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647737280*&#45;&gt;140507647737280 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647737280*&#45;&gt;140507647737280</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e7550>"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# x1 and w1 are leaf nodes with \"*\" operator, similarly with x2 and w2\n",
    "x1.grad = w1.data*x1w1.grad\n",
    "w1.grad = x1.data*x1w1.grad\n",
    "\n",
    "x2.grad = w2.data*x2w2.grad\n",
    "w2.grad = x2.data*x2w2.grad\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b0fee92",
   "metadata": {
    "papermill": {
     "duration": 0.029215,
     "end_time": "2024-07-02T17:11:41.594935",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.565720",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Updating the Value class to do back propagation with backward method"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "f4139678",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.655722Z",
     "iopub.status.busy": "2024-07-02T17:11:41.655315Z",
     "iopub.status.idle": "2024-07-02T17:11:41.668186Z",
     "shell.execute_reply": "2024-07-02T17:11:41.667103Z"
    },
    "papermill": {
     "duration": 0.046407,
     "end_time": "2024-07-02T17:11:41.670974",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.624567",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._backward = lambda: None # Empty function \n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other):\n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad = out.grad\n",
    "            other.grad = out.grad\n",
    "            \n",
    "        out._backward = _backward # Store the function       \n",
    "        return out\n",
    "    \n",
    "    def __mul__(self,other):\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad = other.data*out.grad\n",
    "            other.grad = self.data*out.grad            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out\n",
    "    \n",
    "    def tanh(self):\n",
    "        x = self.data \n",
    "        t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1) # Calculating tanh\n",
    "        out = Value(t, (self, ), 'tanh') \n",
    "        def _backward():\n",
    "            self.grad = (1-t**2)*out.grad\n",
    "        out._backward = _backward # Store the function\n",
    "        return out # Downstream node"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "0dc710f6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.732579Z",
     "iopub.status.busy": "2024-07-02T17:11:41.731759Z",
     "iopub.status.idle": "2024-07-02T17:11:41.766521Z",
     "shell.execute_reply": "2024-07-02T17:11:41.765368Z"
    },
    "papermill": {
     "duration": 0.068037,
     "end_time": "2024-07-02T17:11:41.769178",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.701141",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647354448 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647354448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357664* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357664*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354448&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647354448&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647351904 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647351904</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647356128tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647351904&#45;&gt;140507647356128tanh -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647351904&#45;&gt;140507647356128tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647351904+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647351904+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647351904+&#45;&gt;140507647351904 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647351904+&#45;&gt;140507647351904</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647354496 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647354496</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 246,-91.5 246,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-56.25 37,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-56.25 143,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272* -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647356272*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354496&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354496&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-73.5C254.97,-73.5 263.07,-73.5 270.44,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-77 280.23,-73.5 270.23,-70 270.23,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647357664 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647357664</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 633,-146.5 633,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-111.25 428.5,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-111.25 530,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356224+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647356224+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357664&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647357664&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647357664*&#45;&gt;140507647357664 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647357664*&#45;&gt;140507647357664</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.93,-128.5 352.73,-128.5 362.27,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-132 372.25,-128.5 362.25,-125 362.25,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647356128 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647356128</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh&#45;&gt;140507647356128 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647356128tanh&#45;&gt;140507647356128</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647356224 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647356224</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356224&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647356224&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647356224+&#45;&gt;140507647356224 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647356224+&#45;&gt;140507647356224</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647357280 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647357280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357280&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647357280&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647356272 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647356272</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 635.25,-91.5 635.25,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-56.25 426.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-56.25 532.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356272&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M635.51,-91.85C644.28,-93.08 652.62,-94.24 660.16,-95.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.42,-98.73 669.81,-96.65 660.39,-91.8 659.42,-98.73\"/>\n",
       "</g>\n",
       "<!-- 140507647356272*&#45;&gt;140507647356272 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647356272*&#45;&gt;140507647356272</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.41,-73.5 351.51,-73.5 360.28,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-77 370.21,-73.5 360.21,-70 360.21,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647354256 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647354256</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-110.5 2.25,-146.5 243.75,-146.5 243.75,-110.5 2.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-111.25 39.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-111.25 140.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354256&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354256&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-128.5C253.4,-128.5 262.22,-128.5 270.19,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-132 280.08,-128.5 270.08,-125 270.08,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354352 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647354352</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354352&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647354352&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c68ba00>"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Input\n",
    "x1 = Value(2.0, label = \"x1\")\n",
    "x2 = Value(0.0, label = \"x2\")\n",
    "\n",
    "#Weight\n",
    "w1 = Value(-3.0, label = \"w1\")\n",
    "w2 = Value(1.0,  label = \"w2\")\n",
    "\n",
    "#Bias\n",
    "b = Value(6.8813735870195432, label='b') # The number is chosen to get a \"nice\" looking output later on\n",
    "\n",
    "# Sum of inputs * weights + bias\n",
    "x1w1 = x1*w1; x1w1.label = \"x1w1\"\n",
    "x2w2 = x2*w2; x2w2.label = \"x2w2\"\n",
    "x1w1x2w2 = x1w1 + x2w2; x1w1x2w2.label = \"x1w1 + x2w2\"\n",
    "neuron = x1w1x2w2 + b; neuron.label = \"neuron\"\n",
    "output = neuron.tanh(); output.label = \"output\"\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "3f0f6e80",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.831740Z",
     "iopub.status.busy": "2024-07-02T17:11:41.831338Z",
     "iopub.status.idle": "2024-07-02T17:11:41.862183Z",
     "shell.execute_reply": "2024-07-02T17:11:41.860979Z"
    },
    "papermill": {
     "duration": 0.065149,
     "end_time": "2024-07-02T17:11:41.865245",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.800096",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647354448 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647354448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357664* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357664*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354448&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647354448&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647351904 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647351904</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647356128tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647351904&#45;&gt;140507647356128tanh -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647351904&#45;&gt;140507647356128tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647351904+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647351904+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647351904+&#45;&gt;140507647351904 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647351904+&#45;&gt;140507647351904</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647354496 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647354496</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 246,-91.5 246,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-56.25 37,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-56.25 143,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272* -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647356272*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354496&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354496&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-73.5C254.97,-73.5 263.07,-73.5 270.44,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-77 280.23,-73.5 270.23,-70 270.23,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647357664 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647357664</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 633,-146.5 633,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-111.25 428.5,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-111.25 530,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356224+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647356224+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357664&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647357664&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647357664*&#45;&gt;140507647357664 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647357664*&#45;&gt;140507647357664</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.93,-128.5 352.73,-128.5 362.27,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-132 372.25,-128.5 362.25,-125 362.25,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647356128 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647356128</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh&#45;&gt;140507647356128 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647356128tanh&#45;&gt;140507647356128</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647356224 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647356224</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356224&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647356224&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647356224+&#45;&gt;140507647356224 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647356224+&#45;&gt;140507647356224</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647357280 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647357280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357280&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647357280&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647356272 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647356272</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 635.25,-91.5 635.25,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-56.25 426.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-56.25 532.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356272&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M635.51,-91.85C644.28,-93.08 652.62,-94.24 660.16,-95.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.42,-98.73 669.81,-96.65 660.39,-91.8 659.42,-98.73\"/>\n",
       "</g>\n",
       "<!-- 140507647356272*&#45;&gt;140507647356272 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647356272*&#45;&gt;140507647356272</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.41,-73.5 351.51,-73.5 360.28,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-77 370.21,-73.5 360.21,-70 360.21,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647354256 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647354256</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-110.5 2.25,-146.5 243.75,-146.5 243.75,-110.5 2.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-111.25 39.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-111.25 140.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354256&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354256&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-128.5C253.4,-128.5 262.22,-128.5 270.19,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-132 280.08,-128.5 270.08,-125 270.08,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354352 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647354352</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354352&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647354352&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c68a470>"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Perform backward pass to update gradient\n",
    "# Notice the default grad is 0 so we need to set the output grad to 1 to do back propagation\n",
    "output.grad = 1\n",
    "output._backward()\n",
    "draw_dot(output)\n",
    "# Neuron grad is updated to 0.5 just like before"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "529beca8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:41.928228Z",
     "iopub.status.busy": "2024-07-02T17:11:41.927845Z",
     "iopub.status.idle": "2024-07-02T17:11:41.959128Z",
     "shell.execute_reply": "2024-07-02T17:11:41.957910Z"
    },
    "papermill": {
     "duration": 0.065707,
     "end_time": "2024-07-02T17:11:41.961835",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.896128",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647354448 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647354448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357664* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357664*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354448&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647354448&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647351904 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647351904</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647356128tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647351904&#45;&gt;140507647356128tanh -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647351904&#45;&gt;140507647356128tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647351904+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647351904+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647351904+&#45;&gt;140507647351904 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647351904+&#45;&gt;140507647351904</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647354496 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647354496</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 246,-91.5 246,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-56.25 37,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-56.25 143,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272* -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647356272*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354496&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354496&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-73.5C254.97,-73.5 263.07,-73.5 270.44,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-77 280.23,-73.5 270.23,-70 270.23,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647357664 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647357664</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 633,-146.5 633,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-111.25 428.5,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-111.25 530,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356224+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647356224+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357664&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647357664&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647357664*&#45;&gt;140507647357664 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647357664*&#45;&gt;140507647357664</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.93,-128.5 352.73,-128.5 362.27,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-132 372.25,-128.5 362.25,-125 362.25,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647356128 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647356128</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh&#45;&gt;140507647356128 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647356128tanh&#45;&gt;140507647356128</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647356224 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647356224</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356224&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647356224&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647356224+&#45;&gt;140507647356224 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647356224+&#45;&gt;140507647356224</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647357280 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647357280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357280&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647357280&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647356272 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647356272</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 635.25,-91.5 635.25,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-56.25 426.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-56.25 532.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356272&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M635.51,-91.85C644.28,-93.08 652.62,-94.24 660.16,-95.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.42,-98.73 669.81,-96.65 660.39,-91.8 659.42,-98.73\"/>\n",
       "</g>\n",
       "<!-- 140507647356272*&#45;&gt;140507647356272 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647356272*&#45;&gt;140507647356272</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.41,-73.5 351.51,-73.5 360.28,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-77 370.21,-73.5 360.21,-70 360.21,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647354256 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647354256</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-110.5 2.25,-146.5 243.75,-146.5 243.75,-110.5 2.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-111.25 39.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-111.25 140.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354256&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354256&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-128.5C253.4,-128.5 262.22,-128.5 270.19,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-132 280.08,-128.5 270.08,-125 270.08,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354352 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647354352</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647354352&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647354352&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c689db0>"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neuron._backward()\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "1dd70707",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.031189Z",
     "iopub.status.busy": "2024-07-02T17:11:42.030742Z",
     "iopub.status.idle": "2024-07-02T17:11:42.071390Z",
     "shell.execute_reply": "2024-07-02T17:11:42.070139Z"
    },
    "papermill": {
     "duration": 0.081161,
     "end_time": "2024-07-02T17:11:42.074116",
     "exception": false,
     "start_time": "2024-07-02T17:11:41.992955",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647354448 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647354448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357664* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357664*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354448&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647354448&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647351904 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647351904</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647356128tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647351904&#45;&gt;140507647356128tanh -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647351904&#45;&gt;140507647356128tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647351904+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647351904+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647351904+&#45;&gt;140507647351904 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647351904+&#45;&gt;140507647351904</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647354496 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647354496</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 246,-91.5 246,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-56.25 37,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-56.25 143,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272* -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647356272*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354496&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354496&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-73.5C254.97,-73.5 263.07,-73.5 270.44,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-77 280.23,-73.5 270.23,-70 270.23,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647357664 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647357664</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 633,-146.5 633,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-111.25 428.5,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-111.25 530,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356224+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647356224+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357664&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647357664&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647357664*&#45;&gt;140507647357664 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647357664*&#45;&gt;140507647357664</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.93,-128.5 352.73,-128.5 362.27,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-132 372.25,-128.5 362.25,-125 362.25,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647356128 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647356128</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh&#45;&gt;140507647356128 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647356128tanh&#45;&gt;140507647356128</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647356224 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647356224</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356224&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647356224&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647356224+&#45;&gt;140507647356224 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647356224+&#45;&gt;140507647356224</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647357280 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647357280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647357280&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647357280&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647356272 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647356272</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 635.25,-91.5 635.25,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-56.25 426.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-56.25 532.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356272&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356272&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M635.51,-91.85C644.28,-93.08 652.62,-94.24 660.16,-95.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.42,-98.73 669.81,-96.65 660.39,-91.8 659.42,-98.73\"/>\n",
       "</g>\n",
       "<!-- 140507647356272*&#45;&gt;140507647356272 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647356272*&#45;&gt;140507647356272</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.41,-73.5 351.51,-73.5 360.28,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-77 370.21,-73.5 360.21,-70 360.21,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647354256 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647354256</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-110.5 2.25,-146.5 243.75,-146.5 243.75,-110.5 2.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-111.25 39.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-111.25 140.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354256&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354256&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-128.5C253.4,-128.5 262.22,-128.5 270.19,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-132 280.08,-128.5 270.08,-125 270.08,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354352 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647354352</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647354352&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647354352&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c68a290>"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x1w1x2w2._backward()\n",
    "# Calling backward on a \"stand alone\" node\n",
    "b._backward()\n",
    "# No error\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "c12c3cb2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.145453Z",
     "iopub.status.busy": "2024-07-02T17:11:42.144630Z",
     "iopub.status.idle": "2024-07-02T17:11:42.178326Z",
     "shell.execute_reply": "2024-07-02T17:11:42.176931Z"
    },
    "papermill": {
     "duration": 0.075244,
     "end_time": "2024-07-02T17:11:42.181303",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.106059",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647354448 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647354448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647357664* -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357664*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354448&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647354448&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647351904 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647351904</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-54.5 1209.75,-90.5 1480.5,-90.5 1480.5,-54.5 1209.75,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-55.25 1276,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-55.25 1377.5,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647356128tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-72.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647351904&#45;&gt;140507647356128tanh -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647351904&#45;&gt;140507647356128tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-72.5C1489.32,-72.5 1497.47,-72.5 1505,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-76 1514.76,-72.5 1504.76,-69 1504.76,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647351904+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647351904+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-67.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647351904+&#45;&gt;140507647351904 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647351904+&#45;&gt;140507647351904</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-72.5C1181.23,-72.5 1189.29,-72.5 1198.02,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-76 1207.89,-72.5 1197.89,-69 1197.89,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647354496 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647354496</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 246,-91.5 246,-55.5 0,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-56.25 37,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-56.25 143,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356272* -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647356272*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647354496&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354496&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-73.5C254.97,-73.5 263.07,-73.5 270.44,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-77 280.23,-73.5 270.23,-70 270.23,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647357664 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647357664</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 633,-146.5 633,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-111.25 428.5,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-111.25 530,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356224+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647356224+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357664&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647357664&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647357664*&#45;&gt;140507647357664 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647357664*&#45;&gt;140507647357664</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.93,-128.5 352.73,-128.5 362.27,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-132 372.25,-128.5 362.25,-125 362.25,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647356128 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647356128</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-54.5 1620.19,-90.5 1887.94,-90.5 1887.94,-54.5 1620.19,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-55.25 1683.44,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-55.25 1784.94,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647356128tanh&#45;&gt;140507647356128 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647356128tanh&#45;&gt;140507647356128</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-72.5C1591.81,-72.5 1599.81,-72.5 1608.33,-72.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-76 1618.28,-72.5 1608.28,-69 1608.28,-76\"/>\n",
       "</g>\n",
       "<!-- 140507647356224 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647356224</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356224&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647356224&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1070.2,-82.02C1084.26,-80.25 1097.48,-78.58 1108.81,-77.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.89,-80.67 1118.38,-75.95 1108.02,-73.73 1108.89,-80.67\"/>\n",
       "</g>\n",
       "<!-- 140507647356224+&#45;&gt;140507647356224 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647356224+&#45;&gt;140507647356224</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647357280 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647357280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1.88,-0.5 1.88,-36.5 244.12,-36.5 244.12,-0.5 1.88,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"35.12,-1.25 35.12,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"85.88\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.62,-1.25 136.62,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n",
       "</g>\n",
       "<!-- 140507647357280&#45;&gt;140507647356272* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647357280&#45;&gt;140507647356272*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647356272 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647356272</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 635.25,-91.5 635.25,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-56.25 426.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-56.25 532.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647356272&#45;&gt;140507647356224+ -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356272&#45;&gt;140507647356224+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M635.51,-91.85C644.28,-93.08 652.62,-94.24 660.16,-95.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.42,-98.73 669.81,-96.65 660.39,-91.8 659.42,-98.73\"/>\n",
       "</g>\n",
       "<!-- 140507647356272*&#45;&gt;140507647356272 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647356272*&#45;&gt;140507647356272</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.41,-73.5 351.51,-73.5 360.28,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-77 370.21,-73.5 360.21,-70 360.21,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647354256 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647354256</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-110.5 2.25,-146.5 243.75,-146.5 243.75,-110.5 2.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-111.25 39.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-111.25 140.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647354256&#45;&gt;140507647357664* -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354256&#45;&gt;140507647357664*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-128.5C253.4,-128.5 262.22,-128.5 270.19,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-132 280.08,-128.5 270.08,-125 270.08,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354352 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647354352</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-27.5 807.75,-63.5 1037.25,-63.5 1037.25,-27.5 807.75,-27.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-28.25 832.75,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-28.25 934.25,-63.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-41.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647354352&#45;&gt;140507647351904+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647354352&#45;&gt;140507647351904+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-59.36C1063.27,-62.48 1088.78,-65.58 1108.56,-67.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.95,-71.43 1118.3,-69.16 1108.79,-64.48 1107.95,-71.43\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c689ff0>"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x1w1._backward()\n",
    "x2w2._backward()\n",
    "draw_dot(output) # Same as we have before"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d73477a",
   "metadata": {
    "papermill": {
     "duration": 0.0421,
     "end_time": "2024-07-02T17:11:42.269709",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.227609",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Build a function to back propagate through all the nodes\n",
    "- Currently we call the _backward() manually - we can built a function to backpropagate through all the leaf nodes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "3233a9b7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.345922Z",
     "iopub.status.busy": "2024-07-02T17:11:42.345401Z",
     "iopub.status.idle": "2024-07-02T17:11:42.364521Z",
     "shell.execute_reply": "2024-07-02T17:11:42.363181Z"
    },
    "papermill": {
     "duration": 0.056376,
     "end_time": "2024-07-02T17:11:42.367084",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.310708",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._backward = lambda: None # Empty function \n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other):\n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad = out.grad\n",
    "            other.grad = out.grad\n",
    "            \n",
    "        out._backward = _backward # Store the function       \n",
    "        return out\n",
    "    \n",
    "    def __mul__(self,other):\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad = other.data*out.grad\n",
    "            other.grad = self.data*out.grad            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out\n",
    "    \n",
    "    def tanh(self):\n",
    "        x = self.data \n",
    "        t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1) # Calculating tanh\n",
    "        out = Value(t, (self, ), 'tanh') \n",
    "        def _backward():\n",
    "            self.grad = (1-t**2)*out.grad\n",
    "        out._backward = _backward # Store the function\n",
    "        return out # Downstream node\n",
    "    \n",
    "    def backward(self):\n",
    "        topo = [] # topological list - a graph from left to right since we need the \"upstream nodes\" to define the downstream node\n",
    "        visited = set() # Visisted node\n",
    "        \n",
    "        def build_topo(v):\n",
    "            if v not in visited: #Check if the node is in visited\n",
    "                visited.add(v)\n",
    "                for child in v._prev:\n",
    "                    build_topo(child) # Recursively call this function until there's no child left\n",
    "                topo.append(v) #After all the children of the node is added to topo list, adding itself into topo list\n",
    "       \n",
    "        build_topo(self)        \n",
    "        self.grad = 1 #We would call the backward function on the last node, need to initialize it to 1        \n",
    "        for node in reversed(topo): #Back propagate from the last node\n",
    "            node._backward()\n",
    "            \n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "c1a91198",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.433018Z",
     "iopub.status.busy": "2024-07-02T17:11:42.432564Z",
     "iopub.status.idle": "2024-07-02T17:11:42.467840Z",
     "shell.execute_reply": "2024-07-02T17:11:42.466586Z"
    },
    "papermill": {
     "duration": 0.071461,
     "end_time": "2024-07-02T17:11:42.470449",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.398988",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647724560 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647724560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647726480+ -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647726480+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-127.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-122.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647724560&#45;&gt;140507647726480+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724560&#45;&gt;140507647726480+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1075.73,-118.99C1087.62,-120.44 1098.78,-121.79 1108.55,-122.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.87,-126.42 1118.22,-124.16 1108.72,-119.48 1107.87,-126.42\"/>\n",
       "</g>\n",
       "<!-- 140507647724560+ -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647724560+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647724560+&#45;&gt;140507647724560 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647724560+&#45;&gt;140507647724560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647734304 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647734304</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647734304&#45;&gt;140507647724560+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647734304&#45;&gt;140507647724560+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647734304* -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647734304*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647734304*&#45;&gt;140507647734304 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647734304*&#45;&gt;140507647734304</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647727680 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647727680</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-165.5 4.12,-201.5 241.88,-201.5 241.88,-165.5 4.12,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-166.25 37.38,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-166.25 138.88,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647727680&#45;&gt;140507647734304* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647727680&#45;&gt;140507647734304*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647723600 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647723600</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-109.5 1620.19,-145.5 1887.94,-145.5 1887.94,-109.5 1620.19,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-110.25 1683.44,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-110.25 1784.94,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647723600tanh -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647723600tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-127.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-122.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647723600tanh&#45;&gt;140507647723600 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647723600tanh&#45;&gt;140507647723600</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-127.5C1591.81,-127.5 1599.81,-127.5 1608.33,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-131 1618.28,-127.5 1608.28,-124 1608.28,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647735888 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647735888</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724176* -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647724176*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647735888&#45;&gt;140507647724176* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735888&#45;&gt;140507647724176*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647724176 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647724176</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724176&#45;&gt;140507647724560+ -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647724176&#45;&gt;140507647724560+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647724176*&#45;&gt;140507647724176 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724176*&#45;&gt;140507647724176</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647731568 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647731568</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-110.5 0,-146.5 246,-146.5 246,-110.5 0,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-111.25 37,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-111.25 143,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647731568&#45;&gt;140507647734304* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647731568&#45;&gt;140507647734304*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-128.5C254.97,-128.5 263.07,-128.5 270.44,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-132 280.23,-128.5 270.23,-125 270.23,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724416 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724416</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724416&#45;&gt;140507647724176* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647724416&#45;&gt;140507647724176*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647726480 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647726480</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-109.5 1209.75,-145.5 1480.5,-145.5 1480.5,-109.5 1209.75,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-110.25 1276,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-110.25 1377.5,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647726480&#45;&gt;140507647723600tanh -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647726480&#45;&gt;140507647723600tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-127.5C1489.32,-127.5 1497.47,-127.5 1505,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-131 1514.76,-127.5 1504.76,-124 1504.76,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647726480+&#45;&gt;140507647726480 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647726480+&#45;&gt;140507647726480</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-127.5C1181.23,-127.5 1189.29,-127.5 1198.02,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-131 1207.89,-127.5 1197.89,-124 1197.89,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647731136 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647731136</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-137.5 807.75,-173.5 1037.25,-173.5 1037.25,-137.5 807.75,-137.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-138.25 832.75,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-138.25 934.25,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647731136&#45;&gt;140507647726480+ -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647731136&#45;&gt;140507647726480+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-141.13C1063.27,-137.89 1088.78,-134.68 1108.56,-132.19\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.81,-135.68 1118.3,-130.96 1107.94,-128.74 1108.81,-135.68\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e6560>"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Input\n",
    "x1 = Value(2.0, label = \"x1\")\n",
    "x2 = Value(0.0, label = \"x2\")\n",
    "\n",
    "#Weight\n",
    "w1 = Value(-3.0, label = \"w1\")\n",
    "w2 = Value(1.0,  label = \"w2\")\n",
    "\n",
    "#Bias\n",
    "b = Value(6.8813735870195432, label='b') # The number is chosen to get a \"nice\" looking output later on\n",
    "\n",
    "# Sum of inputs * weights + bias\n",
    "x1w1 = x1*w1; x1w1.label = \"x1w1\"\n",
    "x2w2 = x2*w2; x2w2.label = \"x2w2\"\n",
    "x1w1x2w2 = x1w1 + x2w2; x1w1x2w2.label = \"x1w1 + x2w2\"\n",
    "neuron = x1w1x2w2 + b; neuron.label = \"neuron\"\n",
    "output = neuron.tanh(); output.label = \"output\"\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "198b2185",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.538473Z",
     "iopub.status.busy": "2024-07-02T17:11:42.538041Z",
     "iopub.status.idle": "2024-07-02T17:11:42.570980Z",
     "shell.execute_reply": "2024-07-02T17:11:42.569795Z"
    },
    "papermill": {
     "duration": 0.070073,
     "end_time": "2024-07-02T17:11:42.573812",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.503739",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"1896pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 1895.94 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 1891.94,-206 1891.94,4 -4,4\"/>\n",
       "<!-- 140507647724560 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647724560</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"761.25,-82.5 761.25,-118.5 1083.75,-118.5 1083.75,-82.5 761.25,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"818\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1 + x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"874.75,-83.25 874.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"927.75\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"980.75,-83.25 980.75,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1032.25\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647726480+ -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647726480+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1146.75\" cy=\"-127.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1146.75\" y=\"-122.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647724560&#45;&gt;140507647726480+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647724560&#45;&gt;140507647726480+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1075.73,-118.99C1087.62,-120.44 1098.78,-121.79 1108.55,-122.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1107.87,-126.42 1118.22,-124.16 1108.72,-119.48 1107.87,-126.42\"/>\n",
       "</g>\n",
       "<!-- 140507647724560+ -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647724560+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"698.25\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698.25\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647724560+&#45;&gt;140507647724560 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647724560+&#45;&gt;140507647724560</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M725.62,-100.5C732.57,-100.5 740.61,-100.5 749.39,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"749.36,-104 759.36,-100.5 749.36,-97 749.36,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647734304 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647734304</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-110.5 372,-146.5 635.25,-146.5 635.25,-110.5 372,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"399.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"426.25,-111.25 426.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"532.25,-111.25 532.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"583.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647734304&#45;&gt;140507647724560+ -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647734304&#45;&gt;140507647724560+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M631.77,-110.02C642,-108.53 651.71,-107.12 660.37,-105.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"660.59,-109.37 669.98,-104.46 659.58,-102.44 660.59,-109.37\"/>\n",
       "</g>\n",
       "<!-- 140507647734304* -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647734304*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647734304*&#45;&gt;140507647734304 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647734304*&#45;&gt;140507647734304</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-128.5C343.41,-128.5 351.51,-128.5 360.28,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.21,-132 370.21,-128.5 360.21,-125 360.21,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647727680 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647727680</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1.88,-165.5 1.88,-201.5 244.12,-201.5 244.12,-165.5 1.88,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"35.12,-166.25 35.12,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"85.88\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.62,-166.25 136.62,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n",
       "</g>\n",
       "<!-- 140507647727680&#45;&gt;140507647734304* -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647727680&#45;&gt;140507647734304*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647723600 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647723600</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1620.19,-109.5 1620.19,-145.5 1887.94,-145.5 1887.94,-109.5 1620.19,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1651.82\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1683.44,-110.25 1683.44,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1734.19\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1784.94,-110.25 1784.94,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1836.44\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647723600tanh -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647723600tanh</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1550.35\" cy=\"-127.5\" rx=\"33.85\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1550.35\" y=\"-122.83\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n",
       "</g>\n",
       "<!-- 140507647723600tanh&#45;&gt;140507647723600 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647723600tanh&#45;&gt;140507647723600</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1584.66,-127.5C1591.81,-127.5 1599.81,-127.5 1608.33,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1608.28,-131 1618.28,-127.5 1608.28,-124 1608.28,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647735888 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647735888</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-55.5 2.25,-91.5 243.75,-91.5 243.75,-55.5 2.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-56.25 39.25,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-56.25 140.75,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647724176* -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647724176*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647735888&#45;&gt;140507647724176* -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647735888&#45;&gt;140507647724176*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.16,-73.5C253.4,-73.5 262.22,-73.5 270.19,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.08,-77 280.08,-73.5 270.08,-70 270.08,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647724176 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647724176</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-55.5 374.25,-91.5 633,-91.5 633,-55.5 374.25,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"401.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"428.5,-56.25 428.5,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"479.25\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"530,-56.25 530,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"581.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724176&#45;&gt;140507647724560+ -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647724176&#45;&gt;140507647724560+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M633.38,-91.55C642.99,-92.89 652.11,-94.17 660.3,-95.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"659.68,-98.77 670.07,-96.69 660.65,-91.84 659.68,-98.77\"/>\n",
       "</g>\n",
       "<!-- 140507647724176*&#45;&gt;140507647724176 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647724176*&#45;&gt;140507647724176</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.38,-73.5C343.93,-73.5 352.73,-73.5 362.27,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.25,-77 372.25,-73.5 362.25,-70 362.25,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647731568 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647731568</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-110.5 0,-146.5 246,-146.5 246,-110.5 0,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-111.25 37,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-111.25 143,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647731568&#45;&gt;140507647734304* -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647731568&#45;&gt;140507647734304*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M246.47,-128.5C254.97,-128.5 263.07,-128.5 270.44,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.23,-132 280.23,-128.5 270.23,-125 270.23,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647724416 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647724416</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-0.5 4.12,-36.5 241.88,-36.5 241.88,-0.5 4.12,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-1.25 37.38,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-1.25 138.88,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647724416&#45;&gt;140507647724176* -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647724416&#45;&gt;140507647724176*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M213.15,-36.94C224.3,-39.84 235.47,-43.03 246,-46.5 256.05,-49.81 266.7,-54.13 276.29,-58.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-61.44 285.2,-62.38 277.53,-55.07 274.64,-61.44\"/>\n",
       "</g>\n",
       "<!-- 140507647726480 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647726480</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1209.75,-109.5 1209.75,-145.5 1480.5,-145.5 1480.5,-109.5 1209.75,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1242.88\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1276,-110.25 1276,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1326.75\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1377.5,-110.25 1377.5,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1429\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647726480&#45;&gt;140507647723600tanh -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647726480&#45;&gt;140507647723600tanh</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1480.83,-127.5C1489.32,-127.5 1497.47,-127.5 1505,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1504.76,-131 1514.76,-127.5 1504.76,-124 1504.76,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647726480+&#45;&gt;140507647726480 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647726480+&#45;&gt;140507647726480</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1174.23,-127.5C1181.23,-127.5 1189.29,-127.5 1198.02,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1197.89,-131 1207.89,-127.5 1197.89,-124 1197.89,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647731136 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647731136</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"807.75,-137.5 807.75,-173.5 1037.25,-173.5 1037.25,-137.5 807.75,-137.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"820.25\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"832.75,-138.25 832.75,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"883.5\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"934.25,-138.25 934.25,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"985.75\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647731136&#45;&gt;140507647726480+ -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647731136&#45;&gt;140507647726480+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1037.55,-141.13C1063.27,-137.89 1088.78,-134.68 1108.56,-132.19\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1108.81,-135.68 1118.3,-130.96 1107.94,-128.74 1108.81,-135.68\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e6440>"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output.backward()\n",
    "draw_dot(output)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8be00b71",
   "metadata": {
    "papermill": {
     "duration": 0.03288,
     "end_time": "2024-07-02T17:11:42.640826",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.607946",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# The Bug !\n",
    "\n",
    "So far so good but we do have a bug in the code currently"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "dd4bb8ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.710087Z",
     "iopub.status.busy": "2024-07-02T17:11:42.709172Z",
     "iopub.status.idle": "2024-07-02T17:11:42.739831Z",
     "shell.execute_reply": "2024-07-02T17:11:42.738562Z"
    },
    "papermill": {
     "duration": 0.068772,
     "end_time": "2024-07-02T17:11:42.742516",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.673744",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"592pt\" height=\"45pt\"\n",
       " viewBox=\"0.00 0.00 592.25 45.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 41)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-41 588.25,-41 588.25,4 -4,4\"/>\n",
       "<!-- 140507647728928 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647728928</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"354.75,-0.5 354.75,-36.5 584.25,-36.5 584.25,-0.5 354.75,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"367.25\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"379.75,-1.25 379.75,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"430.5\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"481.25,-1.25 481.25,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"532.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647728928+ -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647728928+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"291.75\" cy=\"-18.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"291.75\" y=\"-13.82\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647728928+&#45;&gt;140507647728928 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647728928+&#45;&gt;140507647728928</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M319.06,-18.5C326.13,-18.5 334.27,-18.5 343.02,-18.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"342.89,-22 352.89,-18.5 342.89,-15 342.89,-22\"/>\n",
       "</g>\n",
       "<!-- 140507647722448 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647722448</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 228.75,-36.5 228.75,-0.5 0,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"24.25,-1.25 24.25,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"125.75,-1.25 125.75,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"177.25\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647722448&#45;&gt;140507647728928+ -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647722448&#45;&gt;140507647728928+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M228.92,-18.5C237.46,-18.5 245.64,-18.5 253.1,-18.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"253.01,-22 263.01,-18.5 253.01,-15 253.01,-22\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c6e6d10>"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a = Value(3, label = \"a\")\n",
    "b = a + a; b.label = \"b\"\n",
    "b.backward()\n",
    "draw_dot(b)\n",
    "\n",
    "#The grad for a should be 2 but since \"a\" is used more than once, the gradient update is overwrite in the \"child\" node\n",
    "#To fix this the gradient should be accumulated if we were to use the node more than once we can add to the current gradient inside the _backward() function using += instead of ="
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "0db6d026",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.811258Z",
     "iopub.status.busy": "2024-07-02T17:11:42.810846Z",
     "iopub.status.idle": "2024-07-02T17:11:42.826574Z",
     "shell.execute_reply": "2024-07-02T17:11:42.825378Z"
    },
    "papermill": {
     "duration": 0.052819,
     "end_time": "2024-07-02T17:11:42.829253",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.776434",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._backward = lambda: None # Empty function \n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other):        \n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += out.grad #Add +=\n",
    "            other.grad += out.grad #Add +=\n",
    "            \n",
    "        out._backward = _backward # Store the function       \n",
    "        return out\n",
    "    \n",
    "    def __mul__(self,other):\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += other.data*out.grad #Add +=\n",
    "            other.grad += self.data*out.grad #Add +=            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out\n",
    "        \n",
    "\n",
    "    def tanh(self):\n",
    "        x = self.data \n",
    "        t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1) # Calculating tanh\n",
    "        out = Value(t, (self, ), 'tanh') \n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += (1-t**2)*out.grad #Add +=\n",
    "            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out # Downstream node\n",
    "    \n",
    "    def backward(self):\n",
    "        topo = [] # topological list - a graph from left to right since we need the \"upstream nodes\" to define the downstream node\n",
    "        visited = set() # Visisted node\n",
    "        \n",
    "        def build_topo(v):\n",
    "            if v not in visited: #Check if the node is in visited\n",
    "                visited.add(v)\n",
    "                for child in v._prev:\n",
    "                    build_topo(child) # Recursively call this function until there's no child left\n",
    "                topo.append(v) #After all the children of the node is added to topo list, adding itself into topo list\n",
    "       \n",
    "        build_topo(self)        \n",
    "        self.grad = 1 #We would call the backward function on the last node, need to initialize it to 1        \n",
    "        for node in reversed(topo): #Back propagate from the last node\n",
    "            node._backward()\n",
    "            \n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "4bdd9210",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:42.897186Z",
     "iopub.status.busy": "2024-07-02T17:11:42.896783Z",
     "iopub.status.idle": "2024-07-02T17:11:42.926295Z",
     "shell.execute_reply": "2024-07-02T17:11:42.925223Z"
    },
    "papermill": {
     "duration": 0.066454,
     "end_time": "2024-07-02T17:11:42.928930",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.862476",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"592pt\" height=\"45pt\"\n",
       " viewBox=\"0.00 0.00 592.25 45.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 41)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-41 588.25,-41 588.25,4 -4,4\"/>\n",
       "<!-- 140507647356944 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647356944</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 228.75,-36.5 228.75,-0.5 0,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"12.12\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"24.25,-1.25 24.25,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"125.75,-1.25 125.75,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"177.25\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 2.0000</text>\n",
       "</g>\n",
       "<!-- 140507647358912+ -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647358912+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"291.75\" cy=\"-18.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"291.75\" y=\"-13.82\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647356944&#45;&gt;140507647358912+ -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647356944&#45;&gt;140507647358912+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M228.92,-18.5C237.46,-18.5 245.64,-18.5 253.1,-18.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"253.01,-22 263.01,-18.5 253.01,-15 253.01,-22\"/>\n",
       "</g>\n",
       "<!-- 140507647358912 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647358912</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"354.75,-0.5 354.75,-36.5 584.25,-36.5 584.25,-0.5 354.75,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"367.25\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"379.75,-1.25 379.75,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"430.5\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"481.25,-1.25 481.25,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"532.75\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647358912+&#45;&gt;140507647358912 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647358912+&#45;&gt;140507647358912</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M319.06,-18.5C326.13,-18.5 334.27,-18.5 343.02,-18.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"342.89,-22 352.89,-18.5 342.89,-15 342.89,-22\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c68b7f0>"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a = Value(3, label = \"a\")\n",
    "b = a + a; b.label = \"b\"\n",
    "b.backward()\n",
    "draw_dot(b) # Grad looks right now"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "76fa6851",
   "metadata": {
    "papermill": {
     "duration": 0.033518,
     "end_time": "2024-07-02T17:11:42.996386",
     "exception": false,
     "start_time": "2024-07-02T17:11:42.962868",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Add additional operations to Value class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "09781649",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:43.068162Z",
     "iopub.status.busy": "2024-07-02T17:11:43.067775Z",
     "iopub.status.idle": "2024-07-02T17:11:43.077031Z",
     "shell.execute_reply": "2024-07-02T17:11:43.075715Z"
    },
    "papermill": {
     "duration": 0.049284,
     "end_time": "2024-07-02T17:11:43.079743",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.030459",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'int' object has no attribute 'data'\n",
      "unsupported operand type(s) for +: 'int' and 'Value'\n",
      "'int' object has no attribute 'data'\n",
      "unsupported operand type(s) for /: 'Value' and 'int'\n",
      "unsupported operand type(s) for ** or pow(): 'Value' and 'int'\n"
     ]
    }
   ],
   "source": [
    "# Currently we can't multiplication or exponential Value to a number\n",
    "\n",
    "\n",
    "a = Value(1.0)\n",
    "try:\n",
    "    print(a + 1)\n",
    "    # a.__add__(1)\n",
    "    # We can fix this by checking to see if the number we add in is an instance of Value, if not we set the number to be an instance of Value\n",
    "    # other = other if isinstance(other,Value) else Value(other)    \n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    \n",
    "try:\n",
    "    print(1 + a)\n",
    "    #1.__add__(a)\n",
    "    # We need other = other if isinstance(other,Value) else Value(other) and also __radd__ for reverse addition\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    \n",
    "try:\n",
    "    print(a * 3)\n",
    "    # a.__mul__(3)\n",
    "    # We can fix this by checking to see if the number we add in is an instance of Value, if not we set the number to be an instance of Value\n",
    "    # other = other if isinstance(other,Value) else Value(other)    \n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    \n",
    "try:\n",
    "    print(a/3)\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "\n",
    "try:\n",
    "    print(a**3)\n",
    "except Exception as e:\n",
    "    print(e)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "eb58bd75",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:43.148817Z",
     "iopub.status.busy": "2024-07-02T17:11:43.148028Z",
     "iopub.status.idle": "2024-07-02T17:11:43.170426Z",
     "shell.execute_reply": "2024-07-02T17:11:43.169348Z"
    },
    "papermill": {
     "duration": 0.059849,
     "end_time": "2024-07-02T17:11:43.173110",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.113261",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Value():\n",
    "    def __init__(self,data, _children = (), _op = \"\", label = \"\"):\n",
    "        self.data = data\n",
    "        self.grad = 0.0 #initially it's 0\n",
    "        self._backward = lambda: None # Empty function \n",
    "        self._prev = set(_children) #Andrej mention he used set for efficiency \n",
    "        self._op = _op\n",
    "        self.label = label\n",
    "        \n",
    "    def __repr__(self):\n",
    "        return f\"Value(data={self.data})\"\n",
    "    \n",
    "    def __add__(self,other):\n",
    "        other = other if isinstance(other,Value) else Value(other) #Check for other if it's Value instance\n",
    "        out = Value(self.data + other.data, (self, other), \"+\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += out.grad #Add +=\n",
    "            other.grad += out.grad #Add +=\n",
    "            \n",
    "        out._backward = _backward # Store the function       \n",
    "        return out\n",
    "    \n",
    "    def __radd__(self, other): # other + self #Reverse Addition\n",
    "        return self + other\n",
    "    \n",
    "    def __mul__(self,other):\n",
    "        other = other if isinstance(other,Value) else Value(other) #Check for other if it's Value instance\n",
    "        out = Value(self.data * other.data, (self,other), \"*\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += other.data*out.grad #Add +=\n",
    "            other.grad += self.data*out.grad #Add +=            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out\n",
    "    \n",
    "    def __rmul__(self,other): # other*self , reverse multiplication\n",
    "        return self * other \n",
    "\n",
    "    def __pow__(self,other):\n",
    "        assert isinstance(other,(int,float)), \"only supporting int/float power for now\"\n",
    "        out = Value(self.data ** other, (self, ), f\"**{other}\")\n",
    "        def _backward():\n",
    "            self.grad += other*self.data**(other - 1) * out.grad\n",
    "        out._backward = _backward        \n",
    "        return out\n",
    "    \n",
    "    def __truediv__(self,other): #division\n",
    "        return self * other**-1\n",
    "    \n",
    "    def __neg__(self): #-self\n",
    "        return self * -1\n",
    "    \n",
    "    def __sub__(self,other): # Subtraction\n",
    "        return self + (-other)\n",
    "        \n",
    "    def exp(self): #Exponential\n",
    "        x = self.data\n",
    "        out = Value(math.exp(x), (self,), \"exp\")\n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += out.data*out.grad # Derivative of e**x is e**x which is output.data. Need to time by output.grad by chain rule        \n",
    "        out._backward = _backward\n",
    "        return out       \n",
    "        \n",
    "    def tanh(self):\n",
    "        x = self.data \n",
    "        t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1) # Calculating tanh\n",
    "        out = Value(t, (self, ), 'tanh') \n",
    "        \n",
    "        def _backward():\n",
    "            self.grad += (1-t**2)*out.grad #Add +=\n",
    "            \n",
    "        out._backward = _backward # Store the function\n",
    "        return out # Downstream node\n",
    "    \n",
    "    def backward(self):\n",
    "        topo = [] # topological list - a graph from left to right since we need the \"upstream nodes\" to define the downstream node\n",
    "        visited = set() # Visisted node\n",
    "        \n",
    "        def build_topo(v):\n",
    "            if v not in visited: #Check if the node is in visited\n",
    "                visited.add(v)\n",
    "                for child in v._prev:\n",
    "                    build_topo(child) # Recursively call this function until there's no child left\n",
    "                topo.append(v) #After all the children of the node is added to topo list, adding itself into topo list\n",
    "       \n",
    "        build_topo(self)        \n",
    "        self.grad = 1 #We would call the backward function on the last node, need to initialize it to 1        \n",
    "        for node in reversed(topo): #Back propagate from the last node\n",
    "            node._backward()\n",
    "            \n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "cdcd3542",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:43.243197Z",
     "iopub.status.busy": "2024-07-02T17:11:43.242783Z",
     "iopub.status.idle": "2024-07-02T17:11:43.251836Z",
     "shell.execute_reply": "2024-07-02T17:11:43.250718Z"
    },
    "papermill": {
     "duration": 0.047533,
     "end_time": "2024-07-02T17:11:43.254459",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.206926",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Value(data=2.0)\n",
      "Value(data=2.0)\n",
      "Value(data=3.0)\n",
      "Value(data=0.3333333333333333)\n",
      "Value(data=1.0)\n"
     ]
    }
   ],
   "source": [
    "a = Value(1.0)\n",
    "try:\n",
    "    print(a + 1)\n",
    "    # a.__add__(1)\n",
    "    # We can fix this by checking to see if the number we add in is an instance of Value, if not we set the number to be an instance of Value\n",
    "    # other = other if isinstance(other,Value) else Value(other)    \n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    \n",
    "try:\n",
    "    print(1 + a)\n",
    "    #1.__add__(a)\n",
    "    # We need other = other if isinstance(other,Value) else Value(other) and also __radd__ for reverse addition\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "\n",
    "\n",
    "try:\n",
    "    print(a * 3)\n",
    "    # a.__mul__(3)\n",
    "    # We can fix this by checking to see if the number we add in is an instance of Value, if not we set the number to be an instance of Value\n",
    "    # other = other if isinstance(other,Value) else Value(other)    \n",
    "except Exception as e:\n",
    "    print(e)\n",
    "    \n",
    "try:\n",
    "    print(a/3)\n",
    "except Exception as e:\n",
    "    print(e)\n",
    "\n",
    "try:\n",
    "    print(a**3)\n",
    "except Exception as e:\n",
    "    print(e)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1958adcf",
   "metadata": {
    "papermill": {
     "duration": 0.033324,
     "end_time": "2024-07-02T17:11:43.321636",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.288312",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Breaking down tanh using the additional operations "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "1ca14cbb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:43.390205Z",
     "iopub.status.busy": "2024-07-02T17:11:43.389810Z",
     "iopub.status.idle": "2024-07-02T17:11:43.429023Z",
     "shell.execute_reply": "2024-07-02T17:11:43.427739Z"
    },
    "papermill": {
     "duration": 0.076634,
     "end_time": "2024-07-02T17:11:43.431830",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.355196",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 9.0.0 (20231125.0833)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"3491pt\" height=\"210pt\"\n",
       " viewBox=\"0.00 0.00 3490.72 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-206 3486.72,-206 3486.72,4 -4,4\"/>\n",
       "<!-- 140507647725568 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>140507647725568</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2863.97,-57.5 2863.97,-93.5 3088.97,-93.5 3088.97,-57.5 2863.97,-57.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2874.22\" y=\"-71.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2884.47,-58.25 2884.47,-93.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2935.22\" y=\"-71.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.1464</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2985.97,-58.25 2985.97,-93.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"3037.47\" y=\"-71.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 4.8284</text>\n",
       "</g>\n",
       "<!-- 140507647737280* -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>140507647737280*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"3151.97\" cy=\"-98.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"3151.97\" y=\"-93.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647725568&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>140507647725568&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M3089.31,-90.33C3098.01,-91.48 3106.33,-92.58 3113.9,-93.58\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"3113.23,-97.03 3123.6,-94.87 3114.15,-90.09 3113.23,-97.03\"/>\n",
       "</g>\n",
       "<!-- 140507647725568**&#45;1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>140507647725568**&#45;1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"2715.47\" cy=\"-71.5\" rx=\"30.16\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"2715.47\" y=\"-66.83\" font-family=\"Times,serif\" font-size=\"14.00\">**&#45;1</text>\n",
       "</g>\n",
       "<!-- 140507647725568**&#45;1&#45;&gt;140507647725568 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>140507647725568**&#45;1&#45;&gt;140507647725568</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2745.93,-71.95C2772.23,-72.36 2812.62,-72.98 2852.22,-73.6\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2852.06,-77.09 2862.12,-73.75 2852.17,-70.1 2852.06,-77.09\"/>\n",
       "</g>\n",
       "<!-- 140507647353392 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>140507647353392</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1981.97,-136.5 1981.97,-172.5 2211.47,-172.5 2211.47,-136.5 1981.97,-136.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1992.22\" y=\"-150.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2002.47,-137.25 2002.47,-172.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2055.47\" y=\"-150.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2108.47,-137.25 2108.47,-172.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2159.97\" y=\"-150.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.1464</text>\n",
       "</g>\n",
       "<!-- 140507647356896+ -->\n",
       "<g id=\"node28\" class=\"node\">\n",
       "<title>140507647356896+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"2274.47\" cy=\"-126.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"2274.47\" y=\"-121.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647353392&#45;&gt;140507647356896+ -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>140507647353392&#45;&gt;140507647356896+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2211.51,-136.37C2220.34,-134.96 2228.8,-133.62 2236.46,-132.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2236.98,-135.86 2246.3,-130.83 2235.88,-128.95 2236.98,-135.86\"/>\n",
       "</g>\n",
       "<!-- 140507647353920 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>140507647353920</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1626.75,-81.5 1626.75,-117.5 1851.75,-117.5 1851.75,-81.5 1626.75,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1637\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1647.25,-82.25 1647.25,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1698\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.7627</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1748.75,-82.25 1748.75,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1800.25\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.2500</text>\n",
       "</g>\n",
       "<!-- 140507647354016exp -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>140507647354016exp</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1916.86\" cy=\"-99.5\" rx=\"29.11\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1916.86\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">exp</text>\n",
       "</g>\n",
       "<!-- 140507647353920&#45;&gt;140507647354016exp -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>140507647353920&#45;&gt;140507647354016exp</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1851.96,-99.5C1860.39,-99.5 1868.49,-99.5 1875.93,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1875.89,-103 1885.89,-99.5 1875.89,-96 1875.89,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647353920* -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>140507647353920*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1563.75\" cy=\"-99.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1563.75\" y=\"-94.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647353920*&#45;&gt;140507647353920 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>140507647353920*&#45;&gt;140507647353920</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1591.1,-99.5C1598.17,-99.5 1606.29,-99.5 1615.02,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1614.85,-103 1624.85,-99.5 1614.85,-96 1614.85,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647357376 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>140507647357376</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1230,-109.5 1230,-145.5 1500.75,-145.5 1500.75,-109.5 1230,-109.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1263.12\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">neuron</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1296.25,-110.25 1296.25,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1347\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1397.75,-110.25 1397.75,-145.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1449.25\" y=\"-123.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647357376&#45;&gt;140507647353920* -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>140507647357376&#45;&gt;140507647353920*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1495.99,-109.02C1506.74,-107.49 1516.93,-106.03 1525.96,-104.75\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1526.21,-108.25 1535.61,-103.37 1525.22,-101.32 1526.21,-108.25\"/>\n",
       "</g>\n",
       "<!-- 140507647357376+ -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>140507647357376+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"1167\" cy=\"-127.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"1167\" y=\"-122.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647357376+&#45;&gt;140507647357376 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>140507647357376+&#45;&gt;140507647357376</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1194.48,-127.5C1201.48,-127.5 1209.54,-127.5 1218.27,-127.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1218.14,-131 1228.14,-127.5 1218.14,-124 1218.14,-131\"/>\n",
       "</g>\n",
       "<!-- 140507647537744 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>140507647537744</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1.88,-55.5 1.88,-91.5 244.12,-91.5 244.12,-55.5 1.88,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"35.12,-56.25 35.12,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"85.88\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.62,-56.25 136.62,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n",
       "</g>\n",
       "<!-- 140507647351760* -->\n",
       "<g id=\"node26\" class=\"node\">\n",
       "<title>140507647351760*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-68.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647537744&#45;&gt;140507647351760* -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>140507647537744&#45;&gt;140507647351760*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M244.42,-73.5C253.63,-73.5 262.41,-73.5 270.36,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-77 280.2,-73.5 270.2,-70 270.2,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647352432 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>140507647352432</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2337.47,-53.5 2337.47,-89.5 2566.97,-89.5 2566.97,-53.5 2337.47,-53.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2347.72\" y=\"-67.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2357.97,-54.25 2357.97,-89.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2408.72\" y=\"-67.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8284</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2459.47,-54.25 2459.47,-89.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2513.22\" y=\"-67.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;0.1036</text>\n",
       "</g>\n",
       "<!-- 140507647352432&#45;&gt;140507647725568**&#45;1 -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>140507647352432&#45;&gt;140507647725568**&#45;1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2567.43,-71.5C2605.32,-71.5 2645.09,-71.5 2673.7,-71.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2673.34,-75 2683.34,-71.5 2673.34,-68 2673.34,-75\"/>\n",
       "</g>\n",
       "<!-- 140507647352432+ -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>140507647352432+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"2274.47\" cy=\"-71.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"2274.47\" y=\"-66.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647352432+&#45;&gt;140507647352432 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>140507647352432+&#45;&gt;140507647352432</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2301.78,-71.5C2308.85,-71.5 2316.99,-71.5 2325.74,-71.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2325.61,-75 2335.61,-71.5 2325.61,-68 2325.61,-75\"/>\n",
       "</g>\n",
       "<!-- 140507647539328 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>140507647539328</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"821.25,-137.5 821.25,-173.5 1050.75,-173.5 1050.75,-137.5 821.25,-137.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"833.75\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"846.25,-138.25 846.25,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"897\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"947.75,-138.25 947.75,-173.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"999.25\" y=\"-151.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647539328&#45;&gt;140507647357376+ -->\n",
       "<g id=\"edge27\" class=\"edge\">\n",
       "<title>140507647539328&#45;&gt;140507647357376+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1051.16,-141.54C1079.33,-138.1 1107.53,-134.65 1128.93,-132.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1129.08,-135.54 1138.58,-130.85 1128.23,-128.59 1129.08,-135.54\"/>\n",
       "</g>\n",
       "<!-- 140507647354016 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>140507647354016</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1984.22,-81.5 1984.22,-117.5 2209.22,-117.5 2209.22,-81.5 1984.22,-81.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1994.47\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2004.72,-82.25 2004.72,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2055.47\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 5.8284</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2106.22,-82.25 2106.22,-117.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2157.72\" y=\"-95.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0429</text>\n",
       "</g>\n",
       "<!-- 140507647354016&#45;&gt;140507647352432+ -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>140507647354016&#45;&gt;140507647352432+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2209.53,-81.69C2219.08,-80.17 2228.22,-78.71 2236.46,-77.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2236.99,-80.86 2246.32,-75.83 2235.89,-73.94 2236.99,-80.86\"/>\n",
       "</g>\n",
       "<!-- 140507647354016&#45;&gt;140507647356896+ -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>140507647354016&#45;&gt;140507647356896+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2209.53,-116.68C2219.08,-118.14 2228.22,-119.55 2236.46,-120.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2235.9,-124.27 2246.32,-122.33 2236.96,-117.35 2235.9,-124.27\"/>\n",
       "</g>\n",
       "<!-- 140507647354016exp&#45;&gt;140507647354016 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>140507647354016exp&#45;&gt;140507647354016</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1946.44,-99.5C1954.13,-99.5 1962.97,-99.5 1972.41,-99.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1972.24,-103 1982.24,-99.5 1972.24,-96 1972.24,-103\"/>\n",
       "</g>\n",
       "<!-- 140507647540384 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>140507647540384</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2.25,-165.5 2.25,-201.5 243.75,-201.5 243.75,-165.5 2.25,-165.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.25,-166.25 39.25,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.75,-166.25 140.75,-201.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"192.25\" y=\"-179.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n",
       "</g>\n",
       "<!-- 140507647352624* -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>140507647352624*</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"309\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"309\" y=\"-123.83\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n",
       "</g>\n",
       "<!-- 140507647540384&#45;&gt;140507647352624* -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>140507647540384&#45;&gt;140507647352624*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-165.07C226.74,-162.47 236.63,-159.61 246,-156.5 256.18,-153.12 266.94,-148.61 276.59,-144.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.99,-147.41 285.55,-139.98 275.01,-141.08 277.99,-147.41\"/>\n",
       "</g>\n",
       "<!-- 140507647353536 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>140507647353536</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1981.97,-26.5 1981.97,-62.5 2211.47,-62.5 2211.47,-26.5 1981.97,-26.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1992.22\" y=\"-40.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2002.47,-27.25 2002.47,-62.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2053.22\" y=\"-40.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2103.97,-27.25 2103.97,-62.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2157.72\" y=\"-40.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;0.1036</text>\n",
       "</g>\n",
       "<!-- 140507647353536&#45;&gt;140507647352432+ -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>140507647353536&#45;&gt;140507647352432+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2211.51,-61.98C2220.34,-63.34 2228.8,-64.64 2236.46,-65.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2235.89,-69.27 2246.3,-67.33 2236.95,-62.35 2235.89,-69.27\"/>\n",
       "</g>\n",
       "<!-- 140507647539952 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>140507647539952</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"4.12,-110.5 4.12,-146.5 241.88,-146.5 241.88,-110.5 4.12,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"20.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37.38,-111.25 37.38,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"88.12\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"138.88,-111.25 138.88,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"190.38\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647539952&#45;&gt;140507647352624* -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>140507647539952&#45;&gt;140507647352624*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M242.35,-128.5C252.31,-128.5 261.82,-128.5 270.35,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.2,-132 280.2,-128.5 270.2,-125 270.2,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647354640 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>140507647354640</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"768,-82.5 768,-118.5 1104,-118.5 1104,-82.5 768,-82.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"831.5\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"895,-83.25 895,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"948\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1001,-83.25 1001,-118.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1052.5\" y=\"-96.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647354640&#45;&gt;140507647357376+ -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>140507647354640&#45;&gt;140507647357376+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1093.86,-118.99C1106.58,-120.49 1118.49,-121.9 1128.83,-123.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1128.34,-126.58 1138.69,-124.28 1129.16,-119.63 1128.34,-126.58\"/>\n",
       "</g>\n",
       "<!-- 140507647354640+ -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>140507647354640+</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"705\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"705\" y=\"-95.83\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n",
       "</g>\n",
       "<!-- 140507647354640+&#45;&gt;140507647354640 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>140507647354640+&#45;&gt;140507647354640</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M732.27,-100.5C739.21,-100.5 747.24,-100.5 756.03,-100.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"756.02,-104 766.02,-100.5 756.02,-97 756.02,-104\"/>\n",
       "</g>\n",
       "<!-- 140507647352624 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>140507647352624</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"374.25,-110.5 374.25,-146.5 639.75,-146.5 639.75,-110.5 374.25,-110.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"404.75\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"435.25,-111.25 435.25,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"486\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"536.75,-111.25 536.75,-146.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"588.25\" y=\"-124.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647352624&#45;&gt;140507647354640+ -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>140507647352624&#45;&gt;140507647354640+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M637.37,-110.02C647.88,-108.52 657.85,-107.09 666.73,-105.82\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"667.19,-109.29 676.6,-104.41 666.2,-102.36 667.19,-109.29\"/>\n",
       "</g>\n",
       "<!-- 140507647352624*&#45;&gt;140507647352624 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>140507647352624*&#45;&gt;140507647352624</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.43,-128.5C344.1,-128.5 353.05,-128.5 362.77,-128.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"362.51,-132 372.51,-128.5 362.51,-125 362.51,-132\"/>\n",
       "</g>\n",
       "<!-- 140507647359296 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>140507647359296</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"1252.88,-54.5 1252.88,-90.5 1477.88,-90.5 1477.88,-54.5 1252.88,-54.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1263.12\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1273.38,-55.25 1273.38,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1324.12\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"1374.88,-55.25 1374.88,-90.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"1426.38\" y=\"-68.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.2203</text>\n",
       "</g>\n",
       "<!-- 140507647359296&#45;&gt;140507647353920* -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>140507647359296&#45;&gt;140507647353920*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1478.33,-87.89C1495.38,-90.24 1511.87,-92.5 1525.68,-94.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1525.19,-97.87 1535.58,-95.76 1526.15,-90.93 1525.19,-97.87\"/>\n",
       "</g>\n",
       "<!-- 140507647537456 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>140507647537456</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 246,-36.5 246,-0.5 0,-0.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"18.5\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"37,-1.25 37,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"90\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"143,-1.25 143,-36.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"194.5\" y=\"-14.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647537456&#45;&gt;140507647351760* -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>140507647537456&#45;&gt;140507647351760*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-36.93C226.74,-39.53 236.63,-42.39 246,-45.5 256.18,-48.88 266.94,-53.39 276.59,-57.8\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"275.01,-60.92 285.55,-62.02 277.99,-54.59 275.01,-60.92\"/>\n",
       "</g>\n",
       "<!-- 140507647737280 -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>140507647737280</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"3214.97,-80.5 3214.97,-116.5 3482.72,-116.5 3482.72,-80.5 3214.97,-80.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"3246.6\" y=\"-94.2\" font-family=\"Times,serif\" font-size=\"14.00\">output</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"3278.22,-81.25 3278.22,-116.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"3328.97\" y=\"-94.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"3379.72,-81.25 3379.72,-116.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"3431.22\" y=\"-94.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n",
       "</g>\n",
       "<!-- 140507647737280*&#45;&gt;140507647737280 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>140507647737280*&#45;&gt;140507647737280</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M3179.25,-98.5C3186.27,-98.5 3194.36,-98.5 3203.13,-98.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"3203.05,-102 3213.05,-98.5 3203.05,-95 3203.05,-102\"/>\n",
       "</g>\n",
       "<!-- 140507647351760 -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>140507647351760</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"372,-55.5 372,-91.5 642,-91.5 642,-55.5 372,-55.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"402.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"433,-56.25 433,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"486\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"539,-56.25 539,-91.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"590.5\" y=\"-69.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n",
       "</g>\n",
       "<!-- 140507647351760&#45;&gt;140507647354640+ -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>140507647351760&#45;&gt;140507647354640+</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M642.25,-91.99C651.05,-93.21 659.4,-94.36 666.95,-95.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"666.21,-98.83 676.6,-96.73 667.17,-91.89 666.21,-98.83\"/>\n",
       "</g>\n",
       "<!-- 140507647351760*&#45;&gt;140507647351760 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>140507647351760*&#45;&gt;140507647351760</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M336.43,-73.5C343.41,-73.5 351.46,-73.5 360.17,-73.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.02,-77 370.02,-73.5 360.02,-70 360.02,-77\"/>\n",
       "</g>\n",
       "<!-- 140507647356896 -->\n",
       "<g id=\"node27\" class=\"node\">\n",
       "<title>140507647356896</title>\n",
       "<polygon fill=\"none\" stroke=\"black\" points=\"2602.97,-108.5 2602.97,-144.5 2827.97,-144.5 2827.97,-108.5 2602.97,-108.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2613.22\" y=\"-122.2\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2623.47,-109.25 2623.47,-144.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2674.22\" y=\"-122.2\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.8284</text>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"2724.97,-109.25 2724.97,-144.5\"/>\n",
       "<text text-anchor=\"middle\" x=\"2776.47\" y=\"-122.2\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.1464</text>\n",
       "</g>\n",
       "<!-- 140507647356896&#45;&gt;140507647737280* -->\n",
       "<g id=\"edge28\" class=\"edge\">\n",
       "<title>140507647356896&#45;&gt;140507647737280*</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2828.13,-119.31C2902.12,-114.54 3001.35,-108.15 3088.97,-102.5 3096.86,-101.99 3105.3,-101.45 3113.35,-100.93\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"3113.46,-104.43 3123.22,-100.29 3113.01,-97.44 3113.46,-104.43\"/>\n",
       "</g>\n",
       "<!-- 140507647356896+&#45;&gt;140507647356896 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>140507647356896+&#45;&gt;140507647356896</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M2301.95,-126.5C2357.9,-126.5 2491.28,-126.5 2591.33,-126.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"2591.23,-130 2601.23,-126.5 2591.23,-123 2591.23,-130\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x7fca7c68ad10>"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# inputs x1,x2\n",
    "x1 = Value(2.0, label='x1')\n",
    "x2 = Value(0.0, label='x2')\n",
    "# weights w1,w2\n",
    "w1 = Value(-3.0, label='w1')\n",
    "w2 = Value(1.0, label='w2')\n",
    "# bias of the neuron\n",
    "b = Value(6.8813735870195432, label='b')\n",
    "# x1*w1 + x2*w2 + b\n",
    "x1w1 = x1*w1; x1w1.label = 'x1*w1'\n",
    "x2w2 = x2*w2; x2w2.label = 'x2*w2'\n",
    "x1w1x2w2 = x1w1 + x2w2; x1w1x2w2.label = 'x1*w1 + x2*w2'\n",
    "neuron = x1w1x2w2 + b; neuron.label = 'neuron'\n",
    "\n",
    "# ---- \n",
    "e = (2*neuron).exp() #Exponential Term in Tanh\n",
    "output = (e - 1) / (e + 1)\n",
    "# ----\n",
    "\n",
    "output.label = 'output'\n",
    "output.backward()\n",
    "draw_dot(output)\n",
    "\n",
    "# The back propagation is the same compared to before"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2e78c596",
   "metadata": {
    "papermill": {
     "duration": 0.035085,
     "end_time": "2024-07-02T17:11:43.502170",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.467085",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- As long as we can do forward pass and backward pass and get the same results , we can do the back propagation on the composite function like tanh or by the \"atomic\" functions that make up tanh\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d83be677",
   "metadata": {
    "papermill": {
     "duration": 0.034855,
     "end_time": "2024-07-02T17:11:43.571630",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.536775",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Double check with PyTorch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "6153094c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:43.643526Z",
     "iopub.status.busy": "2024-07-02T17:11:43.643118Z",
     "iopub.status.idle": "2024-07-02T17:11:47.303712Z",
     "shell.execute_reply": "2024-07-02T17:11:47.302161Z"
    },
    "papermill": {
     "duration": 3.700068,
     "end_time": "2024-07-02T17:11:47.306288",
     "exception": false,
     "start_time": "2024-07-02T17:11:43.606220",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7071066904050358\n",
      "---\n",
      "x2 0.5000001283844369\n",
      "w2 0.0\n",
      "x1 -1.5000003851533106\n",
      "w1 1.0000002567688737\n"
     ]
    }
   ],
   "source": [
    "import torch\n",
    "\n",
    "x1 = torch.Tensor([2.0]).double()                ; x1.requires_grad = True\n",
    "x2 = torch.Tensor([0.0]).double()                ; x2.requires_grad = True\n",
    "w1 = torch.Tensor([-3.0]).double()               ; w1.requires_grad = True\n",
    "w2 = torch.Tensor([1.0]).double()                ; w2.requires_grad = True\n",
    "b = torch.Tensor([6.8813735870195432]).double()  ; b.requires_grad = True\n",
    "neuron = x1*w1 + x2*w2 + b\n",
    "output = torch.tanh(neuron)\n",
    "\n",
    "print(output.data.item())\n",
    "output.backward()\n",
    "\n",
    "print('---')\n",
    "print('x2', x2.grad.item())\n",
    "print('w2', w2.grad.item())\n",
    "print('x1', x1.grad.item())\n",
    "print('w1', w1.grad.item())\n",
    "\n",
    "# Gradient is the same as the manual process"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "59923018",
   "metadata": {
    "papermill": {
     "duration": 0.0418,
     "end_time": "2024-07-02T17:11:47.384004",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.342204",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Building an MLP with Value class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "08949466",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:47.458733Z",
     "iopub.status.busy": "2024-07-02T17:11:47.458041Z",
     "iopub.status.idle": "2024-07-02T17:11:47.463979Z",
     "shell.execute_reply": "2024-07-02T17:11:47.462714Z"
    },
    "papermill": {
     "duration": 0.044972,
     "end_time": "2024-07-02T17:11:47.466491",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.421519",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import random"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bb29927e",
   "metadata": {
    "papermill": {
     "duration": 0.03476,
     "end_time": "2024-07-02T17:11:47.536358",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.501598",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p align=\"center\">\n",
    "  <img src=\"https://miro.medium.com/v2/resize:fit:1400/1*T4ARzySpEQvEnr_9pc78pg.jpeg\" width = \"500\" />\n",
    "</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a5201780",
   "metadata": {
    "papermill": {
     "duration": 0.034616,
     "end_time": "2024-07-02T17:11:47.605806",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.571190",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- For the forward pass:\n",
    "    - Sum all the w*x\n",
    "    - Add b\n",
    "    - Pass through activation function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "542ef253",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:47.677433Z",
     "iopub.status.busy": "2024-07-02T17:11:47.676941Z",
     "iopub.status.idle": "2024-07-02T17:11:47.690472Z",
     "shell.execute_reply": "2024-07-02T17:11:47.689236Z"
    },
    "papermill": {
     "duration": 0.052563,
     "end_time": "2024-07-02T17:11:47.692931",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.640368",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Value(data=-0.8326892342008514)"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "class Neuron: #This is a single neuron\n",
    "    def __init__(self, nin): # Number input to the neuron\n",
    "        self.w = [Value(random.uniform(-1,1)) for _ in range(nin)]\n",
    "        self.b = Value(random.uniform(-1,1))\n",
    "        \n",
    "    def __call__(self, x): # This is the forward pass\n",
    "        act = sum((wi*xi for wi,xi in zip(self.w,x)), self.b) \n",
    "        out = act.tanh()\n",
    "        return out\n",
    "\n",
    "x = [2.0,3.0]\n",
    "n = Neuron(2)\n",
    "n(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "02722d3d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:47.765759Z",
     "iopub.status.busy": "2024-07-02T17:11:47.764670Z",
     "iopub.status.idle": "2024-07-02T17:11:47.779861Z",
     "shell.execute_reply": "2024-07-02T17:11:47.778639Z"
    },
    "papermill": {
     "duration": 0.053773,
     "end_time": "2024-07-02T17:11:47.782265",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.728492",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Value(data=0.07108767537551194),\n",
       " Value(data=0.9997784445348724),\n",
       " Value(data=0.9803952760507201)]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Add Layer of Neuron\n",
    "class Layer: #Layer of Neuron\n",
    "    def __init__(self,nin, nout):\n",
    "        self.neurons = [Neuron(nin) for _ in range(nout)]\n",
    "    def __call__(self,x):\n",
    "        outs = [n(x) for n in self.neurons]\n",
    "        return outs[0] if len(outs) == 1 else outs\n",
    "    \n",
    "x = [2.0,3.0]\n",
    "l = Layer(2,3)\n",
    "l(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "3f74d382",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:47.854981Z",
     "iopub.status.busy": "2024-07-02T17:11:47.854182Z",
     "iopub.status.idle": "2024-07-02T17:11:47.862917Z",
     "shell.execute_reply": "2024-07-02T17:11:47.861580Z"
    },
    "papermill": {
     "duration": 0.048003,
     "end_time": "2024-07-02T17:11:47.865376",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.817373",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class MLP:\n",
    "    def __init__(self,nin, nouts): # Input size to the MLP and list of number of neuron in layers \n",
    "        sz = [nin] + nouts # List of layer size sequentially\n",
    "        self.layers = [Layer(sz[i],sz[i+1]) for i in range(len(nouts))]\n",
    "    def __call__(self,x):\n",
    "        for layer in self.layers:\n",
    "            x = layer(x)\n",
    "        return x   \n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c6da34f7",
   "metadata": {
    "papermill": {
     "duration": 0.035021,
     "end_time": "2024-07-02T17:11:47.935771",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.900750",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p align=\"center\">\n",
    "  <img src=\"https://miro.medium.com/v2/resize:fit:1400/1*3fA77_mLNiJTSgZFhYnU0Q.png\" width = \"500\" />\n",
    "</p>\n",
    "\n",
    "- We can recreate this simple neural net\n",
    "    - 1 input layer with 3 neurons\n",
    "    - 2 hidden layers with 4 neurons each\n",
    "    - 1 output layer with 1 neuron"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "1620abbb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.009513Z",
     "iopub.status.busy": "2024-07-02T17:11:48.009015Z",
     "iopub.status.idle": "2024-07-02T17:11:48.018834Z",
     "shell.execute_reply": "2024-07-02T17:11:48.017609Z"
    },
    "papermill": {
     "duration": 0.049944,
     "end_time": "2024-07-02T17:11:48.021264",
     "exception": false,
     "start_time": "2024-07-02T17:11:47.971320",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Value(data=0.9106133134234151)"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x = [2.0,3.0,-1]\n",
    "m = MLP(3,[4,4,1])\n",
    "m(x)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5932cbe1",
   "metadata": {
    "papermill": {
     "duration": 0.037072,
     "end_time": "2024-07-02T17:11:48.093920",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.056848",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Back Propagation with MLP"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "3ed2ceb3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.169289Z",
     "iopub.status.busy": "2024-07-02T17:11:48.168909Z",
     "iopub.status.idle": "2024-07-02T17:11:48.180087Z",
     "shell.execute_reply": "2024-07-02T17:11:48.178984Z"
    },
    "papermill": {
     "duration": 0.049907,
     "end_time": "2024-07-02T17:11:48.182604",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.132697",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Value(data=0.9106133134234151),\n",
       " Value(data=0.6932442919605404),\n",
       " Value(data=0.9355238663619752),\n",
       " Value(data=0.8468950901137104)]"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xs = [\n",
    "  [2.0, 3.0, -1.0],\n",
    "  [3.0, -1.0, 0.5],\n",
    "  [0.5, 1.0, 1.0],\n",
    "  [1.0, 1.0, -1.0],\n",
    "] # Features\n",
    "\n",
    "ys = [1.0, -1.0, -1.0, 1.0] # desired targets\n",
    "\n",
    "ypred = [m(x) for x in xs]\n",
    "ypred #Not very good at the moment expected ypred to be as close as possible to ys"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a3e9e3f2",
   "metadata": {
    "papermill": {
     "duration": 0.035528,
     "end_time": "2024-07-02T17:11:48.253899",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.218371",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- We need to monitor the performance of the model by a loss function, in this case we use MSE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "a3d96416",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.326793Z",
     "iopub.status.busy": "2024-07-02T17:11:48.326340Z",
     "iopub.status.idle": "2024-07-02T17:11:48.334735Z",
     "shell.execute_reply": "2024-07-02T17:11:48.333607Z"
    },
    "papermill": {
     "duration": 0.047341,
     "end_time": "2024-07-02T17:11:48.337095",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.289754",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Current loss is Value(data=6.64475996268219)\n",
      "Before backward pass the first enuron weight is [Value(data=-0.2155791283001669), Value(data=-0.7863357721927953), Value(data=-0.42482213086702747)] and the grad is 0.0\n",
      "After backward pass the first enuron weight is [Value(data=-0.2155791283001669), Value(data=-0.7863357721927953), Value(data=-0.42482213086702747)] and the grad is 0.6894239315592359\n"
     ]
    }
   ],
   "source": [
    "loss = sum([(yout - ygt)**2 for ygt,yout in zip(ys,ypred)])\n",
    "print(f\"Current loss is {loss}\")\n",
    "# Check for the first neuron's weight and grad\n",
    "print(f\"Before backward pass the first enuron weight is {m.layers[0].neurons[0].w} and the grad is {m.layers[0].neurons[0].w[0].grad}\")\n",
    "# Backward pass\n",
    "loss.backward()\n",
    "print(f\"After backward pass the first enuron weight is {m.layers[0].neurons[0].w} and the grad is {m.layers[0].neurons[0].w[0].grad}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4519ea69",
   "metadata": {
    "papermill": {
     "duration": 0.035376,
     "end_time": "2024-07-02T17:11:48.408259",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.372883",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- Now we need to update the weight and bias for the neural net, to do this we need to access the parameters\n",
    "- Let's create the parameters functions to retrieve them"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "6711e3f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.480790Z",
     "iopub.status.busy": "2024-07-02T17:11:48.480338Z",
     "iopub.status.idle": "2024-07-02T17:11:48.494437Z",
     "shell.execute_reply": "2024-07-02T17:11:48.493297Z"
    },
    "papermill": {
     "duration": 0.05347,
     "end_time": "2024-07-02T17:11:48.496951",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.443481",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Neuron: #This is a single neuron\n",
    "    def __init__(self, nin): # Number input to the neuron\n",
    "        self.w = [Value(random.uniform(-1,1)) for _ in range(nin)]\n",
    "        self.b = Value(random.uniform(-1,1))\n",
    "        \n",
    "    def __call__(self, x): # This is the forward pass\n",
    "        act = sum((wi*xi for wi,xi in zip(self.w,x)), self.b) \n",
    "        out = act.tanh()\n",
    "        return out\n",
    "    \n",
    "    def parameters(self): #New\n",
    "        return self.w + [self.b] # Return a list of parameters\n",
    "\n",
    "class Layer: #Layer of Neuron\n",
    "    def __init__(self,nin, nout):\n",
    "        self.neurons = [Neuron(nin) for _ in range(nout)]\n",
    "        \n",
    "    def __call__(self,x):\n",
    "        outs = [n(x) for n in self.neurons]\n",
    "        return outs[0] if len(outs) == 1 else outs\n",
    "    \n",
    "    def parameters(self): #New\n",
    "        return [p for neuron in self.neurons for p in neuron.parameters()] # This is equivalent for the following code\n",
    "        # params = []\n",
    "        # for neuron in self.neurons:\n",
    "        #    params.extend(neuron.parameters())\n",
    "        #return params\n",
    "\n",
    "class MLP:\n",
    "    def __init__(self,nin, nouts): # Input size to the MLP and list of number of neuron in layers \n",
    "        sz = [nin] + nouts # List of layer size sequentially\n",
    "        self.layers = [Layer(sz[i],sz[i+1]) for i in range(len(nouts))]\n",
    "        \n",
    "    def __call__(self,x):\n",
    "        for layer in self.layers:\n",
    "            x = layer(x)\n",
    "        return x   \n",
    "    \n",
    "    def parameters(self): #New\n",
    "        return [p for layer in self.layers for p in layer.parameters()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "8560e1b7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.569886Z",
     "iopub.status.busy": "2024-07-02T17:11:48.569412Z",
     "iopub.status.idle": "2024-07-02T17:11:48.578043Z",
     "shell.execute_reply": "2024-07-02T17:11:48.576881Z"
    },
    "papermill": {
     "duration": 0.047734,
     "end_time": "2024-07-02T17:11:48.580355",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.532621",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Value(data=0.22496519621557282)"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x = [2.0,3.0,-1]\n",
    "m = MLP(3,[4,4,1]) # Reinitialize the mlp\n",
    "m(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "36a99c9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.653332Z",
     "iopub.status.busy": "2024-07-02T17:11:48.652898Z",
     "iopub.status.idle": "2024-07-02T17:11:48.661828Z",
     "shell.execute_reply": "2024-07-02T17:11:48.660684Z"
    },
    "papermill": {
     "duration": 0.048488,
     "end_time": "2024-07-02T17:11:48.664486",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.615998",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Value(data=0.9194550660221126),\n",
       " Value(data=-0.2607811241457294),\n",
       " Value(data=-0.3024576955939762),\n",
       " Value(data=-0.7100773222901362),\n",
       " Value(data=0.46013863110428654),\n",
       " Value(data=0.2961947987441613),\n",
       " Value(data=-0.42423478595112796),\n",
       " Value(data=0.8347140148687542),\n",
       " Value(data=-0.5971306174020754),\n",
       " Value(data=0.3702437483797254),\n",
       " Value(data=0.2589097816337327),\n",
       " Value(data=-0.4090822962941163),\n",
       " Value(data=-0.7400953846613549),\n",
       " Value(data=0.5993156526324654),\n",
       " Value(data=0.566981809574955),\n",
       " Value(data=0.40324721388245877),\n",
       " Value(data=0.5287084923852439),\n",
       " Value(data=-0.2145242704022543),\n",
       " Value(data=0.8544539097094039),\n",
       " Value(data=0.06770069405430967),\n",
       " Value(data=0.032461321009329636),\n",
       " Value(data=0.6842263870657073),\n",
       " Value(data=0.38774736537191123),\n",
       " Value(data=-0.5308090347077321),\n",
       " Value(data=-0.5491414921588738),\n",
       " Value(data=-0.37714721679378416),\n",
       " Value(data=0.9775582403502303),\n",
       " Value(data=0.9513089510991823),\n",
       " Value(data=-0.6934662671402487),\n",
       " Value(data=-0.7356598352594199),\n",
       " Value(data=0.8990210960801557),\n",
       " Value(data=-0.3975883395714135),\n",
       " Value(data=0.17354912429505198),\n",
       " Value(data=0.9378200628619273),\n",
       " Value(data=0.4100544655332765),\n",
       " Value(data=-0.685178902513494),\n",
       " Value(data=0.6883537565290003),\n",
       " Value(data=-0.9679398198469804),\n",
       " Value(data=0.5598725490133911),\n",
       " Value(data=-0.8690910123593749),\n",
       " Value(data=-0.24476973473799557)]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "m.parameters()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "7b751844",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.740681Z",
     "iopub.status.busy": "2024-07-02T17:11:48.740240Z",
     "iopub.status.idle": "2024-07-02T17:11:48.751258Z",
     "shell.execute_reply": "2024-07-02T17:11:48.750126Z"
    },
    "papermill": {
     "duration": 0.05175,
     "end_time": "2024-07-02T17:11:48.753620",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.701870",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Value(data=0.22496519621557282),\n",
       " Value(data=-0.09228893297558265),\n",
       " Value(data=0.37110981410582883),\n",
       " Value(data=0.08744506125985445)]"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xs = [\n",
    "  [2.0, 3.0, -1.0],\n",
    "  [3.0, -1.0, 0.5],\n",
    "  [0.5, 1.0, 1.0],\n",
    "  [1.0, 1.0, -1.0],\n",
    "] # Features\n",
    "\n",
    "ys = [1.0, -1.0, -1.0, 1.0] # desired targets\n",
    "\n",
    "ypred = [m(x) for x in xs]\n",
    "ypred #Not very good at the moment expected ypred to be as close as possible to ys"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "afb01d51",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.826944Z",
     "iopub.status.busy": "2024-07-02T17:11:48.826498Z",
     "iopub.status.idle": "2024-07-02T17:11:48.834942Z",
     "shell.execute_reply": "2024-07-02T17:11:48.833780Z"
    },
    "papermill": {
     "duration": 0.048226,
     "end_time": "2024-07-02T17:11:48.837644",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.789418",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Current loss is Value(data=4.137316966832124)\n",
      "Before backward pass the first enuron weight is [Value(data=0.9194550660221126), Value(data=-0.2607811241457294), Value(data=-0.3024576955939762)] and the grad is 0.0\n",
      "After backward pass the first enuron weight is [Value(data=0.9194550660221126), Value(data=-0.2607811241457294), Value(data=-0.3024576955939762)] and the grad is 0.8182836476441108\n"
     ]
    }
   ],
   "source": [
    "loss = sum([(yout - ygt)**2 for ygt,yout in zip(ys,ypred)])\n",
    "print(f\"Current loss is {loss}\")\n",
    "# Check for the first neuron's weight and grad\n",
    "print(f\"Before backward pass the first enuron weight is {m.layers[0].neurons[0].w} and the grad is {m.layers[0].neurons[0].w[0].grad}\")\n",
    "# Backward pass\n",
    "loss.backward()\n",
    "print(f\"After backward pass the first enuron weight is {m.layers[0].neurons[0].w} and the grad is {m.layers[0].neurons[0].w[0].grad}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "21c61667",
   "metadata": {
    "papermill": {
     "duration": 0.035678,
     "end_time": "2024-07-02T17:11:48.909218",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.873540",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Gradient decent\n",
    "\n",
    "- We want to nudge the parameters toward the direction to minimize the loss - we want to move it in the opposite direction of the [gradient](https://en.wikipedia.org/wiki/Gradient_descent) - hence the negative sign.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "3a05b5a8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:48.982454Z",
     "iopub.status.busy": "2024-07-02T17:11:48.982044Z",
     "iopub.status.idle": "2024-07-02T17:11:48.987863Z",
     "shell.execute_reply": "2024-07-02T17:11:48.986572Z"
    },
    "papermill": {
     "duration": 0.045396,
     "end_time": "2024-07-02T17:11:48.990351",
     "exception": false,
     "start_time": "2024-07-02T17:11:48.944955",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "for p in m.parameters():\n",
    "    p.data += -0.01*p.grad # This 0.01 is basically the learning rate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "758a7417",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:49.065517Z",
     "iopub.status.busy": "2024-07-02T17:11:49.065080Z",
     "iopub.status.idle": "2024-07-02T17:11:49.188191Z",
     "shell.execute_reply": "2024-07-02T17:11:49.186960Z"
    },
    "papermill": {
     "duration": 0.164187,
     "end_time": "2024-07-02T17:11:49.190573",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.026386",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Value(data=0.34050395443431863),\n",
       " Value(data=-0.058951505759478315),\n",
       " Value(data=0.24454589448625405),\n",
       " Value(data=0.15423217461060995)]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ypred = [m(x) for x in xs]\n",
    "ypred #Not very good at the moment expected ypred to be as close as possible to ys"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "0c660784",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:49.264552Z",
     "iopub.status.busy": "2024-07-02T17:11:49.264145Z",
     "iopub.status.idle": "2024-07-02T17:11:49.271231Z",
     "shell.execute_reply": "2024-07-02T17:11:49.270154Z"
    },
    "papermill": {
     "duration": 0.047005,
     "end_time": "2024-07-02T17:11:49.273801",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.226796",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "New loss is Value(data=3.584725000575612)\n"
     ]
    }
   ],
   "source": [
    "loss = sum([(yout - ygt)**2 for ygt,yout in zip(ys,ypred)])\n",
    "print(f\"New loss is {loss}\") # Loss decrease compared to previous loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "44b1f310",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:49.349610Z",
     "iopub.status.busy": "2024-07-02T17:11:49.349150Z",
     "iopub.status.idle": "2024-07-02T17:11:49.402297Z",
     "shell.execute_reply": "2024-07-02T17:11:49.401170Z"
    },
    "papermill": {
     "duration": 0.095094,
     "end_time": "2024-07-02T17:11:49.405169",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.310075",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0, current loss is Value(data=3.584725000575612)\n",
      "Epoch 1, current loss is Value(data=3.012762305679233)\n",
      "Epoch 2, current loss is Value(data=1.4833228796541404)\n",
      "Epoch 3, current loss is Value(data=0.6584058512553761)\n",
      "Epoch 4, current loss is Value(data=0.6910883867892776)\n",
      "Epoch 5, current loss is Value(data=0.27434777656094517)\n",
      "Epoch 6, current loss is Value(data=0.06551392163446138)\n",
      "Epoch 7, current loss is Value(data=0.1606519757148571)\n",
      "Epoch 8, current loss is Value(data=0.29944564229492965)\n",
      "Epoch 9, current loss is Value(data=0.1016324161309373)\n",
      "Epoch 10, current loss is Value(data=0.020355035722592157)\n",
      "Epoch 11, current loss is Value(data=0.004747052645616097)\n",
      "Epoch 12, current loss is Value(data=0.0014029147008524862)\n",
      "Epoch 13, current loss is Value(data=0.0004991344747397781)\n",
      "Epoch 14, current loss is Value(data=0.00020099833664145676)\n",
      "Epoch 15, current loss is Value(data=8.745734499024426e-05)\n",
      "Epoch 16, current loss is Value(data=4.013333857783969e-05)\n",
      "Epoch 17, current loss is Value(data=2.7844815090520686e-05)\n",
      "Epoch 18, current loss is Value(data=0.003428909241426871)\n",
      "Epoch 19, current loss is Value(data=0.08084898522068734)\n"
     ]
    }
   ],
   "source": [
    "# Let's train this MLP\n",
    "lr = 0.05\n",
    "epochs = 20\n",
    "\n",
    "for epoch in range(epochs):\n",
    "    # Forward pass\n",
    "    ypred = [m(x) for x in xs]\n",
    "    loss = sum([(yout - ygt)**2 for ygt,yout in zip(ys,ypred)])\n",
    "    \n",
    "    # Back proppagation\n",
    "    loss.backward()\n",
    "    \n",
    "    #Update\n",
    "    \n",
    "    for p in m.parameters():\n",
    "        p.data += -lr*p.grad\n",
    "    \n",
    "    print(f\"Epoch {epoch}, current loss is {loss}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "50ffb102",
   "metadata": {
    "papermill": {
     "duration": 0.036069,
     "end_time": "2024-07-02T17:11:49.478567",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.442498",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Another bug"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cd5afb98",
   "metadata": {
    "papermill": {
     "duration": 0.03626,
     "end_time": "2024-07-02T17:11:49.551139",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.514879",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- The gradient is from the previous loss, we have to reset the gradient for the new loss\n",
    "- The reason it works because the current neural net is very simple which the accumulation make the step size \"huge\" "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "cfe5591d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-02T17:11:49.627668Z",
     "iopub.status.busy": "2024-07-02T17:11:49.626548Z",
     "iopub.status.idle": "2024-07-02T17:11:49.683191Z",
     "shell.execute_reply": "2024-07-02T17:11:49.681943Z"
    },
    "papermill": {
     "duration": 0.096775,
     "end_time": "2024-07-02T17:11:49.685623",
     "exception": false,
     "start_time": "2024-07-02T17:11:49.588848",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0, current loss is Value(data=7.048061415684679)\n",
      "Epoch 1, current loss is Value(data=4.2444851247739)\n",
      "Epoch 2, current loss is Value(data=3.5923709256144494)\n",
      "Epoch 3, current loss is Value(data=2.809735335504989)\n",
      "Epoch 4, current loss is Value(data=1.6612598343022689)\n",
      "Epoch 5, current loss is Value(data=1.2036034737472252)\n",
      "Epoch 6, current loss is Value(data=0.7627326274497732)\n",
      "Epoch 7, current loss is Value(data=0.44316365279971803)\n",
      "Epoch 8, current loss is Value(data=0.33059546270656415)\n",
      "Epoch 9, current loss is Value(data=0.27596463847458075)\n",
      "Epoch 10, current loss is Value(data=0.23591585946673496)\n",
      "Epoch 11, current loss is Value(data=0.20543431773475887)\n",
      "Epoch 12, current loss is Value(data=0.18155181161300524)\n",
      "Epoch 13, current loss is Value(data=0.16239035264035628)\n",
      "Epoch 14, current loss is Value(data=0.14671042190251826)\n",
      "Epoch 15, current loss is Value(data=0.13366439911181538)\n",
      "Epoch 16, current loss is Value(data=0.12265490113944136)\n",
      "Epoch 17, current loss is Value(data=0.11324983820270272)\n",
      "Epoch 18, current loss is Value(data=0.10512956085071154)\n",
      "Epoch 19, current loss is Value(data=0.09805289592308301)\n"
     ]
    }
   ],
   "source": [
    "xs = [\n",
    "  [2.0, 3.0, -1.0],\n",
    "  [3.0, -1.0, 0.5],\n",
    "  [0.5, 1.0, 1.0],\n",
    "  [1.0, 1.0, -1.0],\n",
    "] # Features\n",
    "\n",
    "ys = [1.0, -1.0, -1.0, 1.0] # desired targets\n",
    "\n",
    "m = MLP(3,[4,4,1]) # Reinitialize the mlp\n",
    "\n",
    "# Let's train this MLP\n",
    "lr = 0.05\n",
    "epochs = 20\n",
    "\n",
    "for epoch in range(epochs):\n",
    "    # Forward pass\n",
    "    ypred = [m(x) for x in xs]\n",
    "    loss = sum([(yout - ygt)**2 for ygt,yout in zip(ys,ypred)])\n",
    "    \n",
    "    for p in m.parameters(): #New\n",
    "        p.grad = 0\n",
    "    \n",
    "    \n",
    "    # Back proppagation\n",
    "    loss.backward()\n",
    "    \n",
    "    #Update\n",
    "    \n",
    "    for p in m.parameters():\n",
    "        p.data += -lr*p.grad\n",
    "    \n",
    "    print(f\"Epoch {epoch}, current loss is {loss}\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [],
   "dockerImageVersionId": 30732,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 15.436245,
   "end_time": "2024-07-02T17:11:50.645236",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-07-02T17:11:35.208991",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
